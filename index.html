<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eu Existo Por Você | Ádamo F. Costa</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- AOS Animation CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Máscara para inputs (Telefone/CPF) -->
    <script src="https://cdn.jsdelivr.net/npm/imask"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'midnight': '#04060C', 
                        'gold': '#CBA135', 
                        'gold-hover': '#b38b2a',
                        'card-bg': '#0B0F19',
                        'success': '#22c55e'
                    },
                    fontFamily: {
                        serif: ['"Cinzel"', 'serif'],
                        sans: ['"Lato"', 'sans-serif'],
                    },
                    boxShadow: {
                        'glow': '0 0 25px rgba(203, 161, 53, 0.15)',
                        'gold-border': '0 0 0 1px #CBA135'
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos Globais */
        html, body {
            max-width: 100vw;
            overflow-x: hidden;
        }
        body { 
            background-color: #04060C; 
            color: #e2e8f0; 
            font-family: 'Lato', sans-serif;
            font-size: 16px; 
        }

        /* Ajuste de fontes menores para mobile */
        p, span, a, div {
            font-size: max(14px, 1em); 
        }
        
        .text-xs { font-size: 12px !important; }
        .text-\[10px\] { font-size: 11px !important; }
        .text-\[9px\] { font-size: 10px !important; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #04060C; }
        ::-webkit-scrollbar-thumb { background: #CBA135; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #b38b2a; }

        /* Container */
        .mobile-container {
            width: 100%;
            max-width: 500px; 
            margin: 0 auto;
            min-height: 100vh;
            padding: 0 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Botões */
        .btn-primary {
            background-color: #CBA135;
            color: #000;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: 2px; 
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            font-size: 16px;
            cursor: pointer;
            white-space: normal;
            text-align: center;
            border: none;
        }
        .btn-primary:hover { 
            background-color: #b38b2a; 
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(203, 161, 53, 0.3);
        }
        .btn-primary:disabled {
            background-color: #555;
            color: #888;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: 2px;
            width: 100%;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .btn-outline:hover { 
            border-color: #CBA135; 
            color: #CBA135; 
            transform: translateY(-2px);
        }

        /* Tipografia */
        .title-hero { 
            font-family: 'Cinzel', serif; 
            color: white; 
            line-height: 1.3; 
            word-wrap: break-word; 
            hyphens: auto; 
        }
        .title-gold { 
            font-family: 'Cinzel', serif; 
            color: #CBA135; 
            font-style: italic; 
            word-wrap: break-word; 
        }

        /* Elementos */
        .section-box { background-color: #0B0F19; border-radius: 4px; overflow: hidden; margin-bottom: 30px; }
        .price-box { border: 1px solid #CBA135; padding: 30px 20px; text-align: center; background-color: #04060C; transition: transform 0.3s ease; }
        .price-box:hover { box-shadow: 0 0 30px rgba(203, 161, 53, 0.1); }

        .market-tab { opacity: 0.5; filter: grayscale(100%); transition: all 0.3s; cursor: pointer; padding: 5px; border-bottom: 2px solid transparent; display: flex; align-items: center; justify-content: center; }
        .market-tab.active { opacity: 1; filter: grayscale(0%); border-color: #CBA135; transform: scale(1.1); }
        .market-tab:hover { opacity: 0.8; }
        
        /* Abas de Preço */
        .price-tab {
            cursor: pointer;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            background: #0B0F19;
            color: #888;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        .price-tab.active {
            background: #CBA135;
            color: #000;
            border-color: #CBA135;
        }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* FAQ */
        .faq-item { background-color: #0B0F19; border-bottom: 1px solid rgba(255,255,255,0.05); transition: background-color 0.3s; }
        .faq-item:hover { background-color: #111625; }
        .faq-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .faq-open .faq-content { max-height: 500px; }
        .faq-icon { transition: transform 0.3s ease; }
        .faq-open .faq-icon { transform: rotate(180deg); }

        /* Player */
        .music-float { 
            background: rgba(5, 8, 16, 0.90); 
            border: 1px solid rgba(203, 161, 53, 0.3); 
            backdrop-filter: blur(10px); 
            box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
            transition: all 0.3s ease; 
            cursor: pointer;
        }
        .music-float:hover { border-color: #CBA135; transform: translate(-50%, -5px); }
        .music-playing .music-wave { animation: musicWave 1s ease-in-out infinite; }
        
        @keyframes musicWave {
            0% { height: 20%; }
            50% { height: 80%; }
            100% { height: 20%; }
        }

        /* --- ESTILOS DOS MODAIS --- */
        .chapter-modal, .checkout-modal, .auth-modal, .account-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
        }
        .chapter-modal.open, .checkout-modal.open, .auth-modal.open, .account-modal.open {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Container Padrão */
        .modal-container {
            background-color: #0B0F19;
            width: 90%;
            max-width: 600px;
            height: 85%;
            border: 1px solid #CBA135;
            border-radius: 4px;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(203, 161, 53, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        /* Container Ajustável */
        .checkout-container, .auth-container, .account-container {
            background-color: #0B0F19;
            width: 95%;
            max-width: 500px;
            border: 1px solid #CBA135;
            border-radius: 4px;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(203, 161, 53, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            overflow-y: auto;
            max-height: 90vh;
        }
        .account-container { max-width: 800px; }

        .open .modal-container, .open .checkout-container, .open .auth-container, .open .account-container {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #04060C;
        }
        .modal-body {
            padding: 30px;
            overflow-y: auto;
            font-family: 'Lato', sans-serif;
            font-size: 18px; 
            line-height: 1.8;
            color: #d1d5db;
            text-align: justify;
        }
        .modal-body p { margin-bottom: 1.5rem; }
        .close-btn {
            cursor: pointer;
            color: #CBA135;
            transition: transform 0.2s;
        }
        .close-btn:hover { transform: scale(1.1); color: white; }

        /* Inputs */
        .checkout-input {
            width: 100%;
            background: #111625;
            border: 1px solid #333;
            padding: 14px;
            color: white;
            border-radius: 4px;
            margin-bottom: 15px;
            outline: none;
            transition: border-color 0.3s;
            font-size: 16px;
        }
        .checkout-input:focus { border-color: #CBA135; }

        /* Area do Cliente */
        .order-item {
            background: #111625;
            border: 1px solid #333;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-pending { background: #ca8a04; color: black; }
        .status-paid { background: #16a34a; color: white; }
        .status-shipped { background: #2563eb; color: white; }

    </style>
</head>
<body>

    <!-- ÁUDIO DE FUNDO (Link Definitivo GitHub) -->
    <audio id="bg-music" loop>
        <source src="https://github.com/euexistoporvoce/leitura/blob/main/The_Lord_of_the_Rings.mp3?raw=true" type="audio/mpeg">
        Seu navegador não suporta áudio.
    </audio>

    <!-- BARRA SUPERIOR -->
    <div class="fixed top-0 left-0 w-full bg-[#04060C]/95 backdrop-blur-md border-b border-[#CBA135]/20 z-50 py-3 transition-all duration-300 shadow-lg">
        <div class="mobile-container !min-h-0 !py-0 flex justify-between items-center max-w-full">
            <div class="flex items-center gap-2 flex-1 min-w-0 mr-2" data-aos="fade-right">
                <i data-lucide="book" class="w-5 h-5 text-gold flex-shrink-0"></i>
                <!-- Texto ajustável com truncate para não estourar o layout -->
                <div class="flex flex-col">
                    <span class="font-serif text-white font-bold text-[11px] sm:text-xs tracking-widest uppercase truncate">
                        Eu Existo
                    </span>
                    <span class="font-serif text-gold font-bold text-[10px] sm:text-xs tracking-widest uppercase truncate">
                        Por Você
                    </span>
                </div>
            </div>
            
            <div class="flex items-center gap-3">



                
                <!-- Botão Minha Conta (Só aparece se logado) -->
                <div id="btn-account" onclick="openAccount()" class="hidden text-gold hover:text-white cursor-pointer text-xs font-bold flex flex-col items-center">
                    <i data-lucide="user" class="w-5 h-5"></i>
                    <span class="text-[9px] mt-1">PERFIL</span>
                </div>
<div id="btn-admin" onclick="openAdminPanel()" class="hidden text-red-500 hover:text-red-400 cursor-pointer text-xs font-bold flex flex-col items-center border border-red-900 p-1 rounded">
    <i data-lucide="shield" class="w-5 h-5"></i>
    <span class="text-[9px] mt-1">ADMIN</span>
</div>
                <div onclick="checkLoginAndBuy('printed')" class="bg-gold text-black font-bold text-[11px] px-4 py-2 rounded-sm uppercase tracking-wider hover:bg-white transition cursor-pointer flex-shrink-0 whitespace-nowrap shadow-md" data-aos="fade-left">
                    Comprar Agora
                </div>
            </div>
        </div>
    </div>

    <!-- CONTEÚDO PRINCIPAL -->
    <div class="mobile-container pt-24 pb-32">

        <!-- HERO -->
        <div class="text-center mb-12">
            <p class="text-gold text-xs uppercase tracking-[0.3em] font-bold mb-4" data-aos="fade-down">UMA JORNADA REAL</p>
            <h1 class="title-hero text-2xl sm:text-3xl mb-4 leading-snug" data-aos="fade-up" data-aos-delay="100">A HISTÓRIA QUE VAI TE FAZER CHORAR...</h1>
            <h2 class="title-gold text-xl sm:text-2xl mb-8 leading-snug" data-aos="fade-up" data-aos-delay="200">E DEPOIS TE DAR FORÇAS PARA CONTINUAR.</h2>

            <div class="flex text-left mb-10 max-w-sm mx-auto px-2" data-aos="fade-up" data-aos-delay="300">
                <div class="w-1 bg-gold mr-4 flex-shrink-0"></div>
                <p class="text-gray-300 text-base font-light leading-relaxed">
                    Uma jornada real sobre a dor devastadora do luto e a descoberta de que o amor verdadeiro é a única coisa que nos mantém de pé.
                </p>
            </div>

            <div class="space-y-4 mb-8">
                <div data-aos="zoom-in" data-aos-delay="400">
                    <div onclick="checkLoginAndBuy('printed')" class="btn-primary gap-2 cursor-pointer text-base py-4">
                        QUERO MEU LIVRO <i data-lucide="arrow-right" class="w-5 h-5"></i>
                    </div>
                </div>
                <div data-aos="zoom-in" data-aos-delay="500">
                    <a href="#trailer" class="btn-outline gap-2 text-base py-4">
                        <i data-lucide="play-circle" class="w-5 h-5"></i> ASSISTIR TRAILER
                    </a>
                </div>
            </div>

            <!-- Marketplaces -->
            <div class="text-center border-t border-white/10 pt-8" data-aos="fade-in" data-aos-delay="600">
                <p class="text-xs text-gray-500 uppercase tracking-widest mb-6">DISPONÍVEL EM:</p>
                <div class="flex flex-wrap justify-center gap-6 mb-6">
                    <div onclick="switchTab('amazon', 'https://www.amazon.com.br/dp/B0FG7F6N19', 'COMPRAR NA AMAZON')" class="market-tab active" id="tab-amazon"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" class="h-8 filter invert"></div>
                    <div onclick="switchTab('uiclap', 'https://loja.uiclap.com/titulo/ua104467/', 'COMPRAR NA UICLAP')" class="market-tab" id="tab-uiclap"><span class="text-white font-bold font-serif text-xl">UICLAP</span></div>
                    <div onclick="switchTab('ml', 'https://produto.mercadolivre.com.br/MLB-5326863840-livro-eu-existo-por-voc-_JM', 'COMPRAR NO MERCADO LIVRE')" class="market-tab" id="tab-ml"><img src="https://http2.mlstatic.com/frontend-assets/ui-navigation/5.18.9/mercadolibre/logo__large_plus.png" class="h-6 filter invert brightness-0 sepia saturate-0 contrast-200"></div>
                </div>
                <div class="flex flex-wrap justify-center gap-4 mb-6">
                    <div onclick="switchTab('clube', 'https://clubedeautores.com.br/livro/eu-existo-por-voce', 'COMPRAR NO CLUBE')" class="market-tab" id="tab-clube"><div class="bg-purple-700 px-3 py-1.5 rounded text-white font-bold text-xs flex items-center gap-1"><i data-lucide="book-open" class="w-4 h-4"></i> CLUBE</div></div>
                    <div onclick="switchTab('google', 'https://play.google.com/store/books/details/%C3%81damo_F_Costa_Eu_Existo_Por_Voc%C3%AA?id=fz90EQAAQBAJ&pli=1', 'COMPRAR NO GOOGLE PLAY')" class="market-tab" id="tab-google"><div class="bg-gradient-to-r from-blue-500 to-green-500 px-3 py-1.5 rounded text-white font-bold text-xs flex items-center gap-1"><i data-lucide="play" class="w-4 h-4 fill-current"></i> PLAY</div></div>
                    <div onclick="switchTab('apple', 'https://books.apple.com/cz/book/eu-existo-por-voc%C3%AA/id6749249249', 'COMPRAR NO APPLE BOOKS')" class="market-tab" id="tab-apple"><div class="bg-gray-800 border border-gray-600 px-3 py-1.5 rounded text-white font-bold text-xs flex items-center gap-1"><i data-lucide="book" class="w-4 h-4"></i> APPLE</div></div>
                </div>
                
                <div id="market-btn-container" class="hidden fade-in">
                    <a id="market-link" href="#" target="_blank" class="btn-outline border-gold text-gold hover:bg-gold hover:text-black inline-flex items-center gap-2 text-sm py-4 px-8 w-auto">
                        <span id="market-text">IR PARA A LOJA</span> <i data-lucide="external-link" class="w-4 h-4"></i>
                    </a>
                </div>
            </div>
        </div>
  
        <!-- VÍDEO TRAILER E DEPOIMENTOS -->
        <div id="trailer" class="mb-16">
            <div class="text-center mb-8" data-aos="fade-up">
                <p class="text-gold text-xs uppercase tracking-widest font-bold mb-2">IMPACTO REAL</p>
                <h3 class="title-hero text-2xl">O QUE DIZEM SOBRE A OBRA</h3>
            </div>
            
            <div class="aspect-video w-full mb-8 border border-white/10 rounded shadow-2xl bg-black overflow-hidden" data-aos="zoom-in">
                <iframe class="w-full h-full" src="https://www.youtube.com/embed/1QqXw-SAkjM" title="Trailer do Livro" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>

             <div class="max-w-xs mx-auto" data-aos="fade-up" data-aos-delay="100">
                <p class="text-center text-gray-400 text-xs uppercase tracking-widest mb-4">Depoimentos</p>
                <div class="aspect-[9/16] border border-white/10 rounded shadow-xl overflow-hidden bg-black">
                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/PwrTxysB27s" title="Depoimentos" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
            </div>
        </div>

        <!-- DEDICATÓRIA -->
        <div class="text-center mb-16 px-6 border-y border-white/5 py-12" data-aos="fade-up">
            <i data-lucide="heart" class="w-8 h-8 text-gold mx-auto mb-6 opacity-70"></i>
            <h3 class="text-xs text-gold uppercase tracking-[0.2em] mb-6">DEDICATÓRIA</h3>
            <p class="text-gray-300 font-serif italic text-lg leading-relaxed">
                "Em memória de minha esposa amada e de meu querido pai, que permanecem vivos em cada lembrança e gesto de amor... Vocês foram, são e sempre serão a minha força e minha inspiração. Esta história é para vocês."
            </p>
        </div>

        <!-- CAPÍTULOS COM LEITURA -->
        <div class="mb-16">
            <div class="text-center mb-8" data-aos="fade-up">
                <h3 class="title-hero text-2xl uppercase mb-2">FRAGMENTOS DE UMA VIDA</h3>
                <p class="text-xs text-gray-500 uppercase tracking-widest">TOQUE PARA LER UM TRECHO</p>
            </div>

            <div class="space-y-6">
                <!-- Introdução -->
                <div onclick="openModal('modal-intro')" class="bg-[#0B0F19] p-6 border-l-4 border-l-white rounded-r hover:bg-[#111625] transition-all duration-300 cursor-pointer group shadow-md" data-aos="fade-left">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-[10px] text-white font-bold uppercase mb-2 group-hover:text-gold transition-colors">O INÍCIO</p>
                            <h4 class="title-hero text-xl mb-2 group-hover:text-gold transition-colors">INTRODUÇÃO</h4>
                            <p class="text-sm text-gray-400 leading-relaxed">Bem-vindo à leitura de "Eu Existo Por Você". O que você encontrará aqui.</p>
                        </div>
                        <i data-lucide="book-open" class="w-6 h-6 text-gray-500 group-hover:text-white transition-colors"></i>
                    </div>
                    <p class="text-xs text-white mt-4 font-bold uppercase tracking-wider flex items-center gap-1">Ler Introdução <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                </div>

                <!-- Cap 1 -->
                <div onclick="openModal('modal-cap1')" class="bg-[#0B0F19] p-6 border-l-4 border-l-gold rounded-r hover:bg-[#111625] transition-all duration-300 cursor-pointer group shadow-md" data-aos="fade-left" data-aos-delay="50">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-[10px] text-gold font-bold uppercase mb-2 group-hover:text-white transition-colors">CAPÍTULO 1</p>
                            <h4 class="title-hero text-xl mb-2 group-hover:text-gold transition-colors">AVENTURAS INFANTIS</h4>
                            <p class="text-sm text-gray-400 leading-relaxed">Memórias e aprendizados inusitados de uma infância raiz.</p>
                        </div>
                        <i data-lucide="book-open" class="w-6 h-6 text-gold/50 group-hover:text-gold transition-colors"></i>
                    </div>
                    <p class="text-xs text-gold mt-4 font-bold uppercase tracking-wider flex items-center gap-1">Ler Capítulo <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                </div>
                <!-- Cap 2 -->
                <div onclick="openModal('modal-cap2')" class="bg-[#0B0F19] p-6 border-l-4 border-l-gold rounded-r hover:bg-[#111625] transition-all duration-300 cursor-pointer group shadow-md" data-aos="fade-left" data-aos-delay="100"><div class="flex justify-between items-start"><div><p class="text-[10px] text-gold font-bold uppercase mb-2 group-hover:text-white transition-colors">CAPÍTULO 2</p><h4 class="title-hero text-xl mb-2 group-hover:text-gold transition-colors">A DESCIDA SEM FREIO</h4><p class="text-sm text-gray-400 leading-relaxed">A jornada no trem e as loucuras que fazemos quando crianças.</p></div><i data-lucide="book-open" class="w-6 h-6 text-gold/50 group-hover:text-gold transition-colors"></i></div><p class="text-xs text-gold mt-4 font-bold uppercase tracking-wider flex items-center gap-1">Ler Capítulo <i data-lucide="arrow-right" class="w-4 h-4"></i></p></div>
                <!-- Cap 3 -->
                <div onclick="openModal('modal-cap3')" class="bg-[#0B0F19] p-6 border-l-4 border-l-gold rounded-r hover:bg-[#111625] transition-all duration-300 cursor-pointer group shadow-md" data-aos="fade-left" data-aos-delay="200"><div class="flex justify-between items-start"><div><p class="text-[10px] text-gold font-bold uppercase mb-2 group-hover:text-white transition-colors">CAPÍTULO 3</p><h4 class="title-hero text-xl mb-2 group-hover:text-gold transition-colors">LEMBRANÇAS ESCOLARES</h4><p class="text-sm text-gray-400 leading-relaxed">Da inocência às primeiras paixões e as brincadeiras da época.</p></div><i data-lucide="book-open" class="w-6 h-6 text-gold/50 group-hover:text-gold transition-colors"></i></div><p class="text-xs text-gold mt-4 font-bold uppercase tracking-wider flex items-center gap-1">Ler Capítulo <i data-lucide="arrow-right" class="w-4 h-4"></i></p></div>
                <!-- Cap 4 -->
                <div onclick="openModal('modal-cap4')" class="bg-[#0B0F19] p-6 border-l-4 border-l-gold rounded-r hover:bg-[#111625] transition-all duration-300 cursor-pointer group shadow-md" data-aos="fade-left" data-aos-delay="300"><div class="flex justify-between items-start"><div><p class="text-[10px] text-gold font-bold uppercase mb-2 group-hover:text-white transition-colors">CAPÍTULO 4</p><h4 class="title-hero text-xl mb-2 group-hover:text-gold transition-colors">O ENCONTRO QUE MUDARIA TUDO</h4><p class="text-sm text-gray-400 leading-relaxed">Amor à primeira vista e o início da jornada com a mãe da minha filha.</p></div><i data-lucide="book-open" class="w-6 h-6 text-gold/50 group-hover:text-gold transition-colors"></i></div><p class="text-xs text-gold mt-4 font-bold uppercase tracking-wider flex items-center gap-1">Ler Capítulo <i data-lucide="arrow-right" class="w-4 h-4"></i></p></div>
            </div>
        </div>

        <!-- PERSONAGENS -->
        <div class="mb-16">
            <div class="text-center mb-8" data-aos="fade-down">
                <h3 class="title-hero text-xl uppercase mb-2">QUEM VIVE NESTAS PÁGINAS</h3>
                <div class="w-12 h-0.5 bg-gold mx-auto"></div>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-black aspect-square relative group overflow-hidden rounded-sm shadow-lg" data-aos="flip-left" data-aos-delay="0">
                    <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/camila.jpg" class="w-full h-full object-cover grayscale opacity-80 group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute bottom-0 w-full p-3 bg-gradient-to-t from-black via-black/80 to-transparent text-center">
                        <p class="title-hero text-sm">CAMILA</p>
                        <p class="text-[10px] text-gold uppercase">AMOR ETERNO</p>
                    </div>
                </div>
                <div class="bg-black aspect-square relative group overflow-hidden rounded-sm shadow-lg" data-aos="flip-right" data-aos-delay="100">
                    <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/gabriela.jpg" class="w-full h-full object-cover grayscale opacity-80 group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute bottom-0 w-full p-3 bg-gradient-to-t from-black via-black/80 to-transparent text-center">
                        <p class="title-hero text-sm">GABI</p>
                        <p class="text-[10px] text-gold uppercase">A GUERREIRA</p>
                    </div>
                </div>
                <div class="bg-black aspect-square relative group overflow-hidden rounded-sm shadow-lg" data-aos="flip-left" data-aos-delay="200">
                    <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/Spyke.jpg" class="w-full h-full object-cover grayscale opacity-80 group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute bottom-0 w-full p-3 bg-gradient-to-t from-black via-black/80 to-transparent text-center">
                        <p class="title-hero text-sm">SPYKE</p>
                        <p class="text-[10px] text-gold uppercase">O GUARDIÃO</p>
                    </div>
                </div>
                <div class="bg-black aspect-square relative group overflow-hidden rounded-sm shadow-lg" data-aos="flip-right" data-aos-delay="300">
                    <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/adamo.jpg" class="w-full h-full object-cover grayscale opacity-80 group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute bottom-0 w-full p-3 bg-gradient-to-t from-black via-black/80 to-transparent text-center">
                        <p class="title-hero text-sm">O PAI</p>
                        <p class="text-[10px] text-gold uppercase">O EXEMPLO</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- MOMENTOS INESQUECÍVEIS -->
        <div class="mb-12">
            <div class="text-center mb-6" data-aos="fade-up">
                <h2 class="title-serif text-xl">MOMENTOS INESQUECÍVEIS</h2>
                <p class="text-[10px] text-gray-500 uppercase tracking-widest mt-1">GALERIA REAL</p>
            </div>
            <div class="space-y-6">
                <div class="aspect-video relative rounded-sm overflow-hidden border border-white/10 group shadow-lg" data-aos="fade-up">
                    <img src="https://images.unsplash.com/photo-1519741497674-611481863552?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" class="w-full h-full object-cover opacity-70 group-hover:opacity-90 group-hover:scale-105 transition-all duration-500">
                    <div class="absolute bottom-0 w-full p-5 bg-gradient-to-t from-black to-transparent">
                        <p class="title-serif text-xl">O CASAMENTO</p>
                        <p class="text-sm text-gold italic line-clamp-2 leading-snug">"Ela era a noiva mais linda que já vi em toda a minha vida."</p>
                    </div>
                </div>
                <div class="aspect-video relative rounded-sm overflow-hidden border border-white/10 group shadow-lg" data-aos="fade-up">
                    <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/FamiliaUnida.jpg" class="w-full h-full object-cover opacity-70 group-hover:opacity-90 group-hover:scale-105 transition-all duration-500">
                    <div class="absolute bottom-0 w-full p-5 bg-gradient-to-t from-black to-transparent">
                        <p class="title-serif text-xl">FAMÍLIA UNIDA</p>
                        <p class="text-sm text-gold italic line-clamp-2 leading-snug">"Ela dormia no meu colo enquanto eu lidava com um turbilhão de sentimentos."</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- COMPARTILHE SUA HISTÓRIA -->
        <div class="bg-[#0B0F19] p-8 text-center border-l-4 border-gold mb-16 shadow-lg" data-aos="fade-right">
            <h3 class="title-hero text-xl mb-4">COMPARTILHE SUA HISTÓRIA</h3>
            <p class="text-gray-400 text-base italic mb-6 leading-relaxed">
                "Assim como cada página aqui traz um pedaço meu, sei que você também carrega em sua vida momentos únicos. Eu o convido a abrir seu coração."
            </p>
            <p class="text-gold font-bold text-sm mb-1">Use #LivroEuExistoPorVoce</p>
            <p class="text-[10px] text-gray-600 uppercase tracking-widest">No Instagram</p>
        </div>

        <!-- AUTOR -->
        <div class="text-center mb-16">
            <div class="w-32 h-32 mx-auto rounded-full p-1 border border-gold/30 mb-4" data-aos="zoom-in">
                <img src="https://raw.githubusercontent.com/euexistoporvoce/leitura/refs/heads/main/adamo.jpg" alt="Autor" class="w-full h-full rounded-full object-cover grayscale hover:grayscale-0 transition-all duration-700">
            </div>
            <h3 class="title-hero text-2xl mb-1" data-aos="fade-up">ÁDAMO F. COSTA</h3>
            <p class="text-gold text-xs uppercase tracking-[0.3em] mb-6 font-bold" data-aos="fade-up" data-aos-delay="100">AUTOR & PAI</p>
            
            <p class="text-gray-400 text-sm italic leading-relaxed px-4" data-aos="fade-up" data-aos-delay="200">
                "Não escrevi com a mente, nem apenas com o coração; elas nasceram da força da minha alma."
            </p>
            
            <!-- REDES SOCIAIS -->
            <div class="flex flex-wrap justify-center gap-6 mt-8 text-[10px] font-bold text-gray-500 tracking-widest" data-aos="fade-in" data-aos-delay="300">
                <a href="https://api.whatsapp.com/send/?phone=5519991950005" target="_blank" class="hover:text-gold flex flex-col items-center gap-2 transition-colors w-16">
                    <div class="w-10 h-10 rounded-full bg-green-900/30 flex items-center justify-center border border-green-700"><i data-lucide="phone" class="w-5 h-5 text-green-500"></i></div><span>WHATS</span>
                </a>
                <a href="https://www.instagram.com/LivroEuExistoPorVoce.com.br/" target="_blank" class="hover:text-gold flex flex-col items-center gap-2 transition-colors w-16">
                    <div class="w-10 h-10 rounded-full bg-pink-900/30 flex items-center justify-center border border-pink-700"><i data-lucide="instagram" class="w-5 h-5 text-pink-500"></i></div><span>INSTA</span>
                </a>
                <a href="https://www.facebook.com/LivroEuExistoPorVoce/" target="_blank" class="hover:text-gold flex flex-col items-center gap-2 transition-colors w-16">
                    <div class="w-10 h-10 rounded-full bg-blue-900/30 flex items-center justify-center border border-blue-700"><i data-lucide="facebook" class="w-5 h-5 text-blue-500"></i></div><span>FACE</span>
                </a>
                <a href="https://tiktok.com/@livro.eu.existo.por.voce?_r=1&_t=ZS-91ZgLndCn7" target="_blank" class="hover:text-gold flex flex-col items-center gap-2 transition-colors w-16">
                    <div class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center border border-gray-600"><i data-lucide="video" class="w-5 h-5 text-white"></i></div><span>TIKTOK</span>
                </a>
                 <a href="https://kwai.com/@livroeuexistoporvoce" target="_blank" class="hover:text-gold flex flex-col items-center gap-2 transition-colors w-16">
                    <div class="w-10 h-10 rounded-full bg-orange-900/30 flex items-center justify-center border border-orange-600"><i data-lucide="play-circle" class="w-5 h-5 text-orange-500"></i></div><span>KWAI</span>
                </a>
            </div>
        </div>

        <!-- OFERTA PRINCIPAL (Preços Interativos) -->
        <div id="oferta" class="mb-16">
            <div class="text-center mb-8" data-aos="fade-up">
                <h2 class="title-hero text-2xl uppercase mb-2">ADQUIRA SUA CÓPIA</h2>
                <h2 class="title-hero text-2xl uppercase">AGORA</h2>
                <p class="text-gray-500 text-sm mt-4 px-6">Escolha a versão ideal para você.</p>
            </div>

            <!-- Seletor de Abas -->
            <div class="flex justify-center gap-2 mb-6 max-w-xs mx-auto" data-aos="fade-down">
                <div onclick="switchPrice('printed')" id="tab-printed" class="price-tab active rounded-l-sm text-sm py-3">
                    <i data-lucide="book" class="w-4 h-4"></i> LIVRO IMPRESSO
                </div>
                <div onclick="switchPrice('ebook')" id="tab-ebook" class="price-tab rounded-r-sm text-sm py-3">
                    <i data-lucide="smartphone" class="w-4 h-4"></i> E-BOOK
                </div>
            </div>

            <!-- BOX DE PREÇO -->
            <div class="price-box relative shadow-lg" data-aos="zoom-in-up" data-aos-duration="1000">
                <p id="price-title" class="text-gray-400 text-xs uppercase tracking-widest mb-4 text-center font-bold">LIVRO FÍSICO (CAPA FLEXÍVEL) + AUDIO BOOK</p>
                
                <div class="flex justify-center items-center gap-4 mb-8">
                    <div class="text-right">
                        <p class="text-gray-500 text-xs font-bold">R$</p>
                        <p id="price-old" class="text-gray-600 text-sm line-through">109,83</p>
                    </div>
                    <div class="text-gold font-serif font-bold text-5xl leading-none">
                        <span class="text-2xl align-top mr-1">R$</span><span id="price-current">64,69</span>
                    </div>
                </div>

                <div id="price-features" class="space-y-4 mb-8 px-2">
                    <!-- Conteúdo inserido via JS -->
                </div>

                <!-- O botão agora abre o Modal de Checkout -->
                <div onclick="checkLoginAndBuy('printed')" id="price-btn" class="btn-primary mb-4 hover:scale-105 transition-transform cursor-pointer text-base py-4 font-bold shadow-lg">
                    QUERO MEU LIVRO FÍSICO!
                </div>

                <div class="text-center text-[10px] text-gray-500 flex items-center justify-center gap-1 uppercase tracking-widest mt-4">
                    <i data-lucide="lock" class="w-3 h-3"></i> Pagamento 100% Seguro
                </div>
            </div>
        </div>

        <!-- GARANTIA -->
        <div class="text-center mb-12 px-6" data-aos="fade-up">
            <div class="inline-block p-4 rounded-full bg-gold/5 mb-4 border border-gold/20">
                <i data-lucide="shield-check" class="w-8 h-8 text-gold mx-auto"></i>
            </div>
            <h4 class="title-hero text-lg mb-2">GARANTIA DE 7 DIAS</h4>
            <p class="text-sm text-gray-400 leading-relaxed max-w-md mx-auto">
                Seu dinheiro de volta sem perguntas caso não fique satisfeito. Risco zero para você.
            </p>
        </div>

        <!-- FAQ -->
        <div class="space-y-2 mb-16 border-t border-white/5 pt-10">
            <div class="faq-item px-4 py-5 cursor-pointer rounded" onclick="this.classList.toggle('faq-open')" data-aos="fade-up">
                <div class="flex justify-between items-center">
                    <span class="font-bold text-white text-sm uppercase tracking-wide">Como recebo o livro?</span>
                    <i data-lucide="chevron-down" class="w-5 h-5 text-gold faq-icon"></i>
                </div>
                <div class="faq-content">
                    <div class="pt-4 text-gray-400 text-sm leading-relaxed mt-2">
                        Acesso imediato por e-mail após a confirmação do pagamento. Você pode ler no celular, tablet ou computador.
                    </div>
                </div>
            </div>
            <div class="faq-item px-4 py-5 cursor-pointer rounded" onclick="this.classList.toggle('faq-open')" data-aos="fade-up" data-aos-delay="100">
                <div class="flex justify-between items-center">
                    <span class="font-bold text-white text-sm uppercase tracking-wide">Quais as formas de pagamento?</span>
                    <i data-lucide="chevron-down" class="w-5 h-5 text-gold faq-icon"></i>
                </div>
                <div class="faq-content">
                    <div class="pt-4 text-gray-400 text-sm leading-relaxed mt-2">
                        Cartão de crédito, PIX, boleto bancário e PayPal. Tudo processado de forma segura pela Hotmart.
                    </div>
                </div>
            </div>
             <div class="faq-item px-4 py-5 cursor-pointer rounded" onclick="this.classList.toggle('faq-open')" data-aos="fade-up" data-aos-delay="200">
                <div class="flex justify-between items-center">
                    <span class="font-bold text-white text-sm uppercase tracking-wide">Como funciona a garantia?</span>
                    <i data-lucide="chevron-down" class="w-5 h-5 text-gold faq-icon"></i>
                </div>
                <div class="faq-content">
                    <div class="pt-4 text-gray-400 text-sm leading-relaxed mt-2">
                        Você tem 7 dias para testar. Se não gostar, é só pedir reembolso.
                    </div>
                </div>
            </div>
        </div>
        
        <!-- FOOTER -->
        <footer class="text-center text-[10px] text-gray-600 uppercase tracking-widest pb-24 border-t border-white/5 pt-10" data-aos="fade-in">
            <p class="text-white font-serif text-sm mb-2">Eu Existo Por Você</p>
            <p class="mb-6">© 2024 Ádamo F. Costa</p>
            <div class="flex justify-center gap-6">
                <a href="#" class="hover:text-gold transition-colors">Termos</a>
                <a href="#" class="hover:text-gold transition-colors">Privacidade</a>
            </div>
        </footer>
    </div>

    <!-- PLAYER DE MÚSICA FLUTUANTE -->
    <div id="floating-player" class="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 music-float px-5 py-3 rounded-full shadow-2xl flex items-center gap-4 w-max cursor-pointer border border-gold/30 bg-[#04060C]/90 backdrop-blur-md" data-aos="fade-up" data-aos-offset="0" onclick="toggleMusic()">
        <div class="relative w-10 h-10 flex items-center justify-center bg-black/50 rounded-full border border-gold/30">
            <div class="music-wave absolute inset-0 bg-gold/20 rounded-full h-full w-full"></div>
            <i id="music-icon" data-lucide="music" class="w-4 h-4 text-gold relative z-10"></i>
        </div>
        <div class="text-left">
            <p class="text-[9px] text-gold uppercase tracking-widest">Soundtrack</p>
            <p id="music-status" class="text-xs text-white font-bold">Tocar Música</p>
        </div>
        <i id="play-icon" data-lucide="play" class="w-4 h-4 text-white ml-2 fill-current"></i>
    </div>

    <!-- MODAL DE AUTH (ADMINISTRADOR) -->
<div id="modal-admin" class="account-modal">
    <div class="account-container" style="max-width: 1000px; height: 90vh;">
        <div class="modal-header bg-red-900/20 border-b border-red-500/30">
            <div>
                <p class="text-red-500 text-[10px] font-bold uppercase tracking-widest">ÁREA RESTRITA</p>
                <h3 class="text-white font-serif text-xl">GERENCIAMENTO</h3>
            </div>
            <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-admin')"></i>
        </div>

        <div class="flex flex-col h-full overflow-hidden">
            <div class="flex border-b border-gray-800 bg-[#04060C]">
                <button onclick="switchAdminTab('orders')" id="adm-tab-orders" class="flex-1 py-4 text-sm font-bold text-center border-b-2 border-red-500 text-white bg-red-900/10">
                    PEDIDOS
                </button>
                <button onclick="switchAdminTab('clients')" id="adm-tab-clients" class="flex-1 py-4 text-sm font-bold text-center border-b-2 border-transparent text-gray-500 hover:text-white">
                    CLIENTES
                </button>
            </div>

            <div class="flex-1 overflow-y-auto p-6 bg-[#0B0F19]">
                
                <div id="admin-view-orders" class="space-y-4">
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="admin-search-order" placeholder="Buscar pedido (ID, Email ou Nome)..." class="checkout-input mb-0" onkeyup="filterAdminList('order')">
                        <button onclick="loadAdminOrders()" class="btn-primary w-auto px-4 py-2 text-xs"><i data-lucide="refresh-cw"></i></button>
                    </div>
                    <div id="admin-orders-list" class="space-y-3"></div>
                </div>

                <div id="admin-view-clients" class="hidden space-y-4">
            <div class="flex gap-2 mb-4">
    <input type="text" id="admin-search-client" placeholder="Buscar cliente..." class="checkout-input mb-0" onkeyup="filterAdminList('client')">
    <button onclick="openAddClientModal()" class="btn-primary w-auto px-4 py-2 text-xs bg-green-600 hover:bg-green-500 border-none text-white">
        <i data-lucide="plus"></i>
    </button>
    <button onclick="loadAdminClients()" class="btn-primary w-auto px-4 py-2 text-xs"><i data-lucide="refresh-cw"></i></button>
</div>
                    
                    
                    
                    <div id="admin-clients-list" class="grid grid-cols-1 gap-3"></div>
                </div>

            </div>
        </div>
    </div>
</div>

    
    <!-- MODAL DE AUTH (LOGIN/CADASTRO) -->
   <div id="modal-auth" class="auth-modal">
    <div class="auth-container">
        <div class="modal-header">
            <div>
                <p class="text-gold text-[10px] font-bold uppercase tracking-widest" id="wizard-step-indicator">PASSO 1 DE 3</p>
                <h3 id="auth-title" class="text-white font-serif text-xl">CRIAR CONTA</h3>
            </div>
            <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-auth')"></i>
        </div>
        
        <div class="p-6">
            <form id="auth-form" onsubmit="handleAuthSubmit(event)">
                
                <div id="step-1" class="step-content fade-in">
                    <div id="login-fields" class="hidden">
                         <input type="email" id="login-email" placeholder="E-mail" class="checkout-input">
                        <input type="password" id="login-password" placeholder="Senha" class="checkout-input">
                    </div>
                    
                    <div id="register-step-1">
                        <input type="text" id="reg-name" placeholder="Nome Completo" class="checkout-input">
                        <input type="email" id="reg-email" placeholder="E-mail" class="checkout-input">
                        <input type="password" id="reg-password" placeholder="Senha (mín. 6 caracteres)" class="checkout-input">
                    </div>
                </div>

                <div id="step-2" class="step-content hidden fade-in">
                    <p class="text-gray-400 text-sm mb-4">Precisamos dos seus dados para a Nota Fiscal.</p>
                    <input type="text" id="reg-cpf" placeholder="CPF (000.000.000-00)" class="checkout-input">
                    <input type="text" id="reg-phone" placeholder="Celular" class="checkout-input">
                    <input type="text" id="reg-whatsapp" placeholder="WhatsApp" class="checkout-input">
                </div>

                <div id="step-3" class="step-content hidden fade-in">
                    <p class="text-gray-400 text-sm mb-4">Para onde devemos enviar?</p>
                    <div class="flex gap-2">
                        <input type="text" id="reg-cep" placeholder="CEP" class="checkout-input" onblur="buscarEndereco(this.value)">
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="reg-city" placeholder="Cidade" class="checkout-input flex-1">
                        <input type="text" id="reg-state" placeholder="UF" class="checkout-input w-16">
                    </div>
                    <input type="text" id="reg-street" placeholder="Rua / Avenida" class="checkout-input">
                    <div class="flex gap-2">
                        <input type="text" id="reg-number" placeholder="Número" class="checkout-input w-24">
                        <input type="text" id="reg-comp" placeholder="Complemento" class="checkout-input flex-1">
                    </div>
                    <input type="text" id="reg-district" placeholder="Bairro" class="checkout-input">
                </div>

                <div class="mt-6 flex flex-col gap-3">
                    <button type="button" id="btn-next" onclick="nextStep()" class="btn-primary w-full text-base font-bold shadow-md">
                        CONTINUAR <i data-lucide="arrow-right" class="w-4 h-4 ml-2"></i>
                    </button>
                    
                    <button type="submit" id="btn-submit" class="hidden btn-primary w-full text-base font-bold shadow-md bg-green-600 hover:bg-green-500 text-white border-none">
                        FINALIZAR CADASTRO E PAGAR
                    </button>
                    
                    <button type="button" id="btn-login-action" onclick="performLogin()" class="hidden btn-primary w-full">
                        ENTRAR
                    </button>

                    <p class="text-center text-gray-400 text-xs cursor-pointer hover:text-white" onclick="toggleAuthMode()">
                        <span id="auth-switch-text">Já tem conta? Fazer Login</span>
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

    <!-- MODAL DE MINHA CONTA -->
    <div id="modal-account" class="account-modal">
    <div class="account-container" style="max-width: 900px; height: 90vh;">
        <div class="modal-header">
            <div class="flex items-center gap-3">
                <i data-lucide="user-circle" class="w-8 h-8 text-gold"></i>
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">MINHA CONTA</p>
                    <h3 id="user-name-display" class="text-white font-serif text-lg leading-none">CARREGANDO...</h3>
                </div>
            </div>
            <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-account')"></i>
        </div>

        <div class="flex flex-col md:flex-row h-full overflow-hidden">
            <div class="w-full md:w-64 bg-[#04060C] border-r border-gray-800 p-4 flex flex-col gap-2 shrink-0">
                <button onclick="switchUserTab('orders')" id="btn-tab-orders" class="text-left px-4 py-3 rounded text-sm font-bold bg-[#111625] text-gold border border-gold/30 hover:bg-[#1a2030] transition-colors flex items-center gap-2">
                    <i data-lucide="package"></i> MEUS PEDIDOS
                </button>
                <button onclick="switchUserTab('data')" id="btn-tab-data" class="text-left px-4 py-3 rounded text-sm font-bold text-gray-400 hover:text-white hover:bg-[#111625] transition-colors flex items-center gap-2">
                    <i data-lucide="file-text"></i> MEUS DADOS
                </button>
                <div class="mt-auto pt-4 border-t border-gray-800">
                    <button onclick="logout()" class="text-red-500 text-xs font-bold hover:text-red-400 flex items-center gap-2 px-4">
                        <i data-lucide="log-out" class="w-4 h-4"></i> SAIR DA CONTA
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-6 bg-[#0B0F19] relative">
                
                <div id="tab-user-orders" class="space-y-4">
                    <h4 class="text-white font-serif text-xl mb-4 border-b border-gray-800 pb-2">HISTÓRICO DE PEDIDOS</h4>
                    <div id="account-orders-list" class="space-y-3">
                        </div>
                </div>

                <div id="order-details-view" class="hidden absolute inset-0 bg-[#0B0F19] z-20 p-6 overflow-y-auto transform transition-transform">
                    <button onclick="hideOrderDetails()" class="mb-4 text-xs text-gold flex items-center gap-1 hover:underline">
                        <i data-lucide="arrow-left" class="w-3 h-3"></i> VOLTAR PARA LISTA
                    </button>
                    
                    <div id="order-details-content">
                        </div>
                </div>

                <div id="tab-user-data" class="hidden space-y-4">
                    <h4 class="text-white font-serif text-xl mb-4 border-b border-gray-800 pb-2">MEUS DADOS CADASTRAIS</h4>
                    <form id="user-data-form" onsubmit="saveUserData(event)">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-500 uppercase">Nome Completo</label>
                                <input type="text" id="profile-name" class="checkout-input mt-1" required>
                            </div>
                            <div>
                                <label class="text-xs text-gray-500 uppercase">CPF</label>
                                <input type="text" id="profile-cpf" class="checkout-input mt-1">
                            </div>
                            <div>
                                <label class="text-xs text-gray-500 uppercase">Telefone / WhatsApp</label>
                                <input type="text" id="profile-phone" class="checkout-input mt-1">
                            </div>
                            <div>
                                <label class="text-xs text-gray-500 uppercase">E-mail (Não alterável)</label>
                                <input type="email" id="profile-email" class="checkout-input mt-1 bg-black/50 text-gray-500 border-gray-800 cursor-not-allowed" readonly>
                            </div>
                            <div class="md:col-span-2">
                                <label class="text-xs text-gray-500 uppercase">Endereço Completo</label>
                                <textarea id="profile-address" class="checkout-input mt-1 h-24 resize-none" placeholder="Rua, Número, Bairro, Cidade, CEP..."></textarea>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary mt-4 w-auto px-8 py-3 text-sm">SALVAR ALTERAÇÕES</button>
                    </form>
                </div>

            </div>
        </div>
    </div>
</div>
     <!-- MODAIS DE LEITURA -->
    
    <!-- Modal Introdução -->
    <div id="modal-intro" class="chapter-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">INÍCIO</p>
                    <h3 class="text-white font-serif text-xl">INTRODUÇÃO</h3>
                </div>
                <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-intro')"></i>
            </div>
            <div class="modal-body">
                <p>Este livro não é apenas uma coleção de memórias; é um testemunho de como sobreviver às perdas e encontrar significado em meio ao caos. Quando a dor é profunda, a solidão nos assola como se ninguém pudesse entender. Eu me sentia assim até perceber que, ao compartilhar minha história, poderia dar voz a sentimentos e experiências silenciosas de muitos.</p>
                <p>Aqui, você acompanhará minha jornada: de jovem apaixonado pela vida a pai que, de repente, perdeu o chão e precisou encontrar forças para criar sua filha. Esta não é uma história de contos de fadas, mas uma narrativa de força, do amor que sempre me moveu e da coragem que precisei para ser pai.</p>
                <p>Talvez você encontre partes de si mesmo nestas páginas: nas lutas que parecem intransponíveis, nas vitórias inesperadas e nas lembranças que aquecem o coração, mesmo nos dias mais difíceis. Às vezes, são essas lembranças que nos salvam, e acredito que você verá o poder delas em cada parte desta história.</p>
                <p>Meu nome é Ádamo, e o que você encontrará aqui é uma história real, que provavelmente ainda está se desenrolando enquanto lê cada Capítulo. Decidi escrevê-la pensando em quantas pessoas podem passar por situações semelhantes, que nos fazem querer desistir.</p>
                <p>Acredito que todo sofrimento tem um propósito e que podemos transformar nossa dor em apoio para aqueles que, em momentos de tristeza, não enxergam a luz no fim do túnel. Desejo transformar minha tristeza, angústia e luta em inspiração para que você continue, resistindo ao caminho mais fácil e tentador, que sempre nos assedia. Passei por isso dia e noite, e confesso que, até hoje, esses pensamentos retornam. Não encontrei uma forma de apagá-los, mas descobri um antídoto diário para evitar que se tornem um mal maior. Peço que escute minha história e abra seu coração para entender a oportunidade que a vida nos oferece quando vivemos pelo amor em um mundo materialista que nos oprime.</p>
                <p>Tudo o que você verá a partir de agora são relatos reais da minha vida, a qual você começará a explorar. É a história de luta de um homem viúvo que, após perder a esposa, criou sozinho sua filha de 11 meses, enfrentando diversas dificuldades, incluindo a oposição dos avós maternos, que tentaram tirá-la de mim. Você encontrará amor, determinação e superação, mas também luta, injustiças e sofrimento. É dessa combinação que desejo que você tire forças para continuar. Nada foi fácil, e esta história não foge à regra. Ela reflete a força e a fragilidade da natureza humana, provando que, mesmo nas situações mais difíceis, ainda podemos encontrar esperança e felicidade no amor verdadeiro.</p>
                <p>Você não encontrará aqui uma história de viagens, festas ou felicidade material, como nas redes sociais. Sou uma pessoa simples, que batalha diariamente para viver da melhor forma possível dentro das minhas limitações, enfrentando angústias, dores, depressão e experimentando picos de alegria e felicidade. São esses momentos que revelam o segredo de viver o amor verdadeiro e dão força para seguir em frente. Ainda não sei qual será o final desta história — se será feliz como nos contos de fadas —, pois a vivo diariamente. Mas posso assegurar que, a cada dia, tento torná-la um conto de fadas. Cabe a mim viver o peso da realidade, mas também transformar esse peso em contos de fadas, dragões, princesas e castelos na vida da minha amada princesa. Ainda não lhe disse o nome dela, certo? Foi proposital, pois o citarei várias vezes ao longo da história. Afinal, que história de superação seria essa sem a personagem principal, como em todo bom conto de fadas... mas, neste caso, um conto da vida real.</p>
            </div>
        </div>
    </div>

    <!-- Modal Cap 1 -->
    <div id="modal-cap1" class="chapter-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">CAPÍTULO 1</p>
                    <h3 class="text-white font-serif text-xl">AVENTURAS INFANTIS</h3>
                </div>
                <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-cap1')"></i>
            </div>
            <div class="modal-body">
                <p>Antes de prosseguirmos com esta história, peço licença para voltar um pouco no tempo. Acredito que o passado molda o presente e, por isso, desejo compartilhar memórias que marcaram profundamente minha vida. Tenho certeza de que, ao final deste capítulo, você entenderá por que essas histórias são tão importantes. Meu nome é Ádamo, e esta é a parte da minha vida que chamo de memórias reais e recordações.</p>
                <p>Já parou para pensar como nossas memórias são seletivas? Lembramos vagamente de momentos bons, enquanto os ruins parecem ser gravados com tinta permanente em nossas mentes. Lembro-me de poucos momentos felizes do dia a dia, mas guardo com nitidez os eventos marcantes que ocorreram quando eu tinha cerca de 10 anos. Nessa época, minha mãe correu atrás de mim com uma faca, tentando me matar. Se eu não tivesse me trancado no banheiro, possivelmente não estaria aqui contando esta história. (É estranho, mas, ao relatar isso para alguém, consigo visualizar a cena como se estivesse acontecendo novamente.)</p>
                <p>Não me julgue; não me lembro ao certo do motivo, mas sei que não aprontei nada muito diferente do que uma criança faria. Também não julgue minha mãe; cada um tem seus motivos, e esse é um dos pontos principais aos quais quero que preste atenção. Sobre minha mãe, outras memórias me vêm à mente: como a de quando, ao completar 22 anos, ela me expulsou de casa por discutir com minha irmã por causa de um cachorro. Fui morar em uma pequena loja de dois cômodos. O local não tinha chuveiro nem cozinha; era composto por duas salas, onde ficavam meu computador e os produtos que eu vendia, e um banheiro apenas com o vaso sanitário. Ali começou uma parte da nossa história juntos: a da superação. Contarei essa história com mais detalhes nos próximos capítulos.</p>
                <p>Outra lembrança é a de quando, durante esse tempo, minha avó sofreu um golpe de estelionato por telefone. Recebi uma ligação do meu tio me acusando de ser o autor do golpe; supostamente se identificaram com meu nome. No dia do golpe, eu havia passado dois dias trabalhando sem parar, mas estava feliz por ter consertado o equipamento de que precisava para continuar trabalhando. Fiquei sem entender nada quando meu tio me ligou me acusando; minha esposa explicou que trabalhamos na empresa duas noites seguidas sem dormir e que, mesmo que houvesse a possibilidade, eu nunca teria coragem de fazer isso. Confesso que foi uma acusação muito estranha. Felizmente algum tempo depois, os autores foram presos pela polícia enquanto aplicavam o mesmo golpe. Mesmo assim, nunca ouvi um pedido de desculpas. Conto isso para mostrar que todos sofremos injustiças, ainda que desmerecidas, e logo mais contarei coisas muito piores. Preste bem atenção agora: "Se eu ainda estou aqui, você também tem todos os motivos para estar."</p>
                <p>Você reparou que citei apenas momentos ruins da minha vida, sem mencionar os bons? Sim, eu tive momentos bons: corria na rua, soltava pipa, jogava bola e até mesmo "béts" (dependendo da sua idade, talvez nem saiba o que é isso). O mundo gira tão rápido... Penso que, enquanto você está ouvindo isso agora, eu jogava "béts" e usávamos disquetes em um computador que hoje mal serve como sanduicheira. Antigamente, o foco era outro. Ninguém vivia no celular, até porque, naquela época, ligações com mais de uma hora poderiam facilmente custar o equivalente à parcela de um carro ou de uma casa. Lembro-me de uma cena engraçada que gostaria de compartilhar. Um dia, "hackeei" o sistema da Telefônica. Para quem não conhece, era uma empresa que instalava orelhões por todo o Brasil, para que as pessoas ligassem para casa quando estivessem na rua, já que nem sonhávamos com celulares. Como fiz isso? Peguei um daqueles telefones de discar com a mão e cortei os fios; fomos até um orelhão, puxamos os fios de trás, cortamos e... voilà! Podíamos fazer ligações ilimitadas para todo o país, sem gastar um crédito sequer. Surpreendente, não? Na época, éramos os hackers da era telefônica analógica. Mas, como tudo que é bom dura pouco, dois dias depois o técnico veio arrumar o orelhão. Não consideramos a possibilidade de alguém ter ligado para avisar que não estava funcionando, pois esquecemos de religar os fios de trás. Coisa de meninos, só ação e nada de raciocínio. (Acho que eu tinha uns 12 ou 13 anos.) Surgiu uma nova ideia: por que não descascar os fios em vez de cortá-los? E aí veio a "brilhante" ideia de queimar os fios para derreter o plástico, evitando o corte. Na teoria, parecia genial e, confesso, até impressionante, mas, novamente, sem qualquer raciocínio lógico, somente a prática. Começou bem; o fogo estava controlado, só que em seguida descobrimos que o plástico era inflamável e as chamas começaram a se espalhar para o orelhão. Em meio ao desespero, alguém teve a "genial" ideia de apagar o fogo com a mão. Já pode imaginar, né? Vamos pular essa parte, pois é um pouco vergonhosa, tenho que admitir. Acredite, tenho lembranças melhores para compartilhar no próximo capítulo.</p>
            </div>
        </div>
    </div>

    <!-- Modal Cap 2 -->
    <div id="modal-cap2" class="chapter-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">CAPÍTULO 2</p>
                    <h3 class="text-white font-serif text-xl">A DESCIDA SEM FREIO</h3>
                </div>
                <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-cap2')"></i>
            </div>
            <div class="modal-body">
                <p>Memórias como está me trazem outras lembranças à mente. Lembro-me também de quando, ainda criança, estávamos jogando "béts" na rua de casa, uma ladeira onde jogávamos no topo em uma rua sem saída. Nesse dia ensolarado, minha mãe me gritou no portão para ir almoçar; um dos amigos estava com uma bicicleta, então pensei em unir o útil ao agradável. (Naquela época, poucas pessoas tinham uma bicicleta; ao menos onde eu vivia, era outra realidade.)</p>
                <p>Olhando para ele e sua bicicleta, tive uma ideia: por que não dizer que eu o levaria no cano para descermos juntos mais rápido? Inicialmente, ele hesitou, mas confesso que, desde criança, sou um pouco argumentativo. Não lembro ao certo o argumento, mas ele aceitou.</p>
                <p>Meu amigo: "- Olha, a bicicleta está sem freio, vai devagar, ok?" Confirmei; ele sentou no cano e tudo parecia bem. Começamos a descer e, então, entrou a gravidade. Veja bem: ele estava sozinho antes, e agora estávamos os dois. Dobro do peso, dobro da velocidade na descida. Hoje entendo isso. Tarde? Sim, mas entendo.</p>
                <p>Passando pela frente de sua casa, ele começou a gritar: "- Freia, aperta o freio!" Apertei os freios e, lembrei que... não havia freio. Eu gritei: "Está sem freio!" Ele falou: "Freia com o chinelo!" E eu, no desespero, coloquei o pé no pneu e... lembrei que estava descalço, estilo criança raiz. (Se você tiver mais de trinta anos, provavelmente entenderá.) Continuamos ladeira abaixo, gritando desesperadamente por nossas mães, até batermos de frente com um portão.</p>
                <p>Levantei sem sentir dor, mas senti minha cabeça molhada; ao tocar no líquido, descobri que era meu sangue que estava jorrando. Era assustador, mas hoje acho até engraçado; não desmaiei nem me assustei. A pior parte? Avisaram minha família, e minha irmã mais velha desceu a rua correndo. Chegando ao local, a pedido do meu vizinho (que já estava lá me socorrendo), pediu à minha irmã para trazer algo para estancar meu sangue; deram a ela papel higiênico! Pois é, ela nem hesitou e colocou aquilo na minha cabeça. Papel higiênico com sangue quente vira uma "paçoca"; e isso eu aprendi ao chegar ao hospital. O médico gritou comigo: 'Quem colocou essa merda na sua cabeça?' Enquanto esfregava minha cabeça sob a água e outro costurava os pontos. Hoje, lembro com calafrios do "tratamento raiz" da época. Os médicos não eram politicamente corretos; falavam o que lhes vinha à mente. Naquela época era assim: ou você sobrevivia ou morria com mertiolate. Quem viveu isso sabe do que estou falando.</p>
                <p>Ao final, tudo deu certo; ganhei cinco pontos na cabeça, uma cicatriz grande e 20 dias sem ir para a escola. Essa era a parte boa. Outra coisa interessante era que rachar a cabeça fazia de você uma celebridade instantânea. Várias pessoas me visitavam para ouvir a história e na escola, eu era a atração da vez. E, confesso, eu era um pouco pentelho, mas qual criança não é? Acho que você deve estar pensando: depois desta, ele com certeza sossegou. Vamos continuar lendo a seguir e você tire suas próprias conclusões sobre isso.</p>
                <p>Me recordei de outra lembrança ainda mais antiga, como a do dia em que peguei todas as velas da minha mãe para "fazer uma fogueirinha" no porão. Acho que a fogueirinha ficou um pouco descontrolada, pois as labaredas começaram a subir até o teto. Imagine o pequeno desespero de um moleque tentando apagar o fogo com água... e só aumentava. Em meio ao desespero, comecei a gritar por socorro aos meus pais. Sabe, eu realmente não entendo como os indígenas de desenho animado conseguiam fazer sinal de fumaça com tanta eficiência. Todo pano que eu jogava no fogo queimava como se não houvesse amanhã. Aquele dia foi bem construtivo: rendeu um teto queimado do porão e uns três vergões de chinelo Ryder nas pernas. Naquela época, o chinelo não era uma Havaianas molinha; era duro como um tijolo e, se pegasse na cabeça, possivelmente era pior do que uma pancada de bicicleta no portão.</p>
                <p>Bom, acho que já contei detalhes suficientes da minha vida, mas, se me permite, gostaria de compartilhar mais uma memória, e é bem possível que você ache está engraçada. Vamos avançar alguns anos, aproximadamente para os meus 15 anos, numa cidadezinha do interior de São Paulo chamada Sumaré. Meu primo morava lá, e eu costumava passar alguns dias com minha família nessa cidade durante as férias escolares. Agora que você já conhece o cenário, vamos continuar. Estávamos eu e meu bom primo, que, diga-se de passagem, era uma criança bem preguiçosa - logo você entenderá o motivo dessa descrição. Ali perto morava outro primo, e era comum irmos à casa dele para brincar. Naquela época, carro era artigo de luxo, e dinheiro era para a passagem do ônibus ("coisa de gente adulta para ir trabalhar"). Íamos de chinelo mesmo e andávamos cerca de 15 km para chegar à casa desse outro primo. Para facilitar a compreensão, vamos chamar o primo preguiçoso de Ale.</p>
                <p>Naquele dia, Ale estava com muita preguiça de andar e teve a brilhante ideia de cortar caminho pela linha do trem. Bom, sejamos sinceros, ninguém gosta de andar 15 km para ir e mais 15 km para voltar, então resolvi aceitar a ideia. ("Parecia brilhante no momento, e agora, enquanto escrevo, me lembro de alguma história infantil em que o personagem pega o caminho mais curto e acaba se dando mal; guarde esta informação na sua mente. Mas vamos lá, o que importa aqui é a história, certo?") Estávamos eu e Ale descendo a rua em direção aos trilhos do trem. Vou narrar a conversa para que você possa entender e vivenciar esse momento comigo. Ale: "- Vamos lá, primo! Vamos cortar caminho pela linha do trem, assim não temos que andar todo o caminho." Eu: "- Fechou, primo! Vamos pela linha, assim chegamos mais rápido e podemos brincar mais tempo." Lá estávamos nós, andando pela linha, pegando pedras no caminho e jogando no mato, conversando, até que nos deparamos com um trem enorme parado à nossa frente. Vocês já devem imaginar que coisa boa daí não sairia, certo? Duas crianças e um trem só poderiam resultar em problema.</p>
                <p>Quando estávamos passando pelo segundo vagão, Ale, aquela criança preguiçosa que mencionei antes, disse: Ale: "- Primo, tive uma ideia! Vamos chegar muito mais rápido." Eu: "Como assim, primo? O que você está pensando em fazer?" Ale: "- Vamos subir no trem e segurar no vagão; assim, quando ele parar lá na frente, na estação, a gente desce e já estará praticamente na casa do tio." Eu: "- Nem ferrando, primo! Não faço isso nem morto. E se cairmos do vagão?" Ale: "- Deixa de ser cagão, primo! Faço isso sempre, é fácil. Se você não for, eu vou." Eu: " - Tá bom, mas você faz isso sempre, né? Tem certeza de que ele para lá na frente?" Ale: "Claro, primo! Sobe e segura; assim que chegarmos na estação, é só descer de boa." Eu: " - Então, beleza." Após essa conversa, subimos no vagão e seguramos na escada. Eu, de blusa branca regata e shorts florido (na época, era moda) e com um celular Nokia primeira geração, o "tijolão". Em poucos minutos, o trem começou a partir. No início, deu um pouco de medo, mas, quando as coisas não dão errado de cara, você começa a gostar da aventura e aí mora o perigo real. O trem começou a andar e a ganhar velocidade. Estávamos pendurados na escada do vagão, duas crianças rindo e se divertindo, esperando o trem parar na estação de Sumaré, aproximadamente uns 9 km adiante.</p>
                <p>Como nem tudo são flores, o plano, que parecia perfeito, desmoronou quando meu primo fez uma cara de desespero ao ver a estação passando ao nosso lado, com o trem já a uns 60 km/h. Ele olhou para mim e disse: Ale: "- Primo, fodeu! O trem passou reto pela estação. Meu Deus, estamos ferrados." (Pausa para descrever o sentimento naquele instante. Imagine-se, pendurado num trem a 60km/h, segurando uma escada, vestindo apenas shorts, camiseta regata e chinelo Havaianas. Tudo isso graças à ideia "brilhante" de alguém que garantia saber o que fazia. E, de repente, essa mesma pessoa olha para você com uma cara de "volta o cão arrependido, com as orelhas tão fartas, com o osso roído e o rabo entre as patas".) (Tá bom, tá bom. Confesso, essa frase é uma musiquinha do Chaves, mas não há forma melhor de descrever a cara de desespero dele naquele momento.) Se a expressão dele era de desespero, você precisava ver a minha. Eu congelei; fiquei viajando na minha mente, pensando: "Pera aí, não foi ele quem disse que isso era normal, que fazia sempre? Calma aí, meu Deus, fodeu! Estou ferrado, vou morrer!" E, comecei a expressar meus sentimentos, falando e gritando: “ Eu vou morrer!" Certa vez, ouvi dizer: pior do que está não fica. Pois bem, vou provar que nem tudo o que ouvimos é verdade. A situação em que nos encontrávamos ainda era das melhores; o que vem a seguir vai te surpreender.</p>
                <p>Uns 10 km depois de passarmos da estação, meu primo, em meio ao nosso desespero frenético, teve outra ideia brilhante e disse: Ale: "- Primo, o trem passou reto pela estação; vamos ter que pular!" Eu: "- O quê? Você está louco? Não pulo nem ferrando desse trem! E se eu cair nos trilhos? Vou morrer." Ale: " Nada a ver, primo! Eu faço isso sempre. Eu pulo primeiro, você olha como eu faço e depois faz igual. Só tome cuidado para pular longe do trem, senão você cai embaixo dele." Mais uma pequena pausa. (Notou que ele, mais uma vez, teve uma ideia "brilhante" que ele "sempre fazia"? Só queria frisar essa informação antes de continuarmos.) Eu: “ Tá bom, primo. Já que você faz isso sempre, pula primeiro; eu vejo e depois faço igual." Lembro-me como se fosse ontem: fecho os olhos e vejo claramente a imagem do meu primo pulando, caindo de bunda no chão, fazendo uma cara de dor indescritível e rolando com as pernas para perto das rodas da linha do trem. (Não sei qual é a sua religião ou em que você acredita, mas ali foi um milagre.) Na minha mente, eu vi meu primo perder as duas pernas, mas, por um sopro divino ou um empurrão angelical, ele rolou de forma misteriosa para o lado, escapando de cair na linha do trem. Isso foi o suficiente para desencorajar qualquer pessoa em sa consciência naquele momento. Agora, por um instante, coloque-se no meu lugar. Imagine você, já em meio ao desespero, olhando para alguém que, supostamente, era perito em pular de trens em movimento, fazendo isso "sempre", e olhar o perito saltando e caindo com uma expressão de dor insuportável, quase sendo cortado ao meio na linha do trem.</p>
                <p>Não, o instinto de sobrevivência fala mais alto. Ao presenciar aquela cena, eu soube que nunca pularia dali de forma alguma. Pensei comigo: " Eu pular? Ele, com toda aquela "experiência” quase morreu!" (Se eu tentasse, com certeza não estaria aqui escrevendo esta história. Poderia até psicografar do plano espiritual, mas com absoluta certeza não deste plano.) Recuperando-se do tombo e aliviado por estar vivo, ele começou a me gritar: Ale: "- Pula! Pula, primo! Pula logo!" Eu me lembro apenas de olhar para ele e gritar: Eu: "- Nem ferrando! Vou parar na próxima estação, e você se vira para ir me buscar. Eu é que não vou pular e morrer." Agarrei firme a escada do vagão e segui para a próxima estação. Ali, sozinho, sem nunca ter feito aquilo antes e, com certeza, sem querer fazer novamente, estava eu, em um trem a uma velocidade de 60km/h. Essa velocidade pode não parecer muita dentro de um carro, mas em um vagão de trem, segurando em pé numa escada, usando chinelo Havaianas e sentindo os trancos dos vagões nas curvas... são momentos indescritíveis; só estando lá para entender. Nem comento o fato de ficar olhando para o chão enquanto o trem se movia. O que não sabíamos, mas percebi mais tarde nas curvas que o trem fazia, era que tínhamos pego um trem com pelo menos 100 vagões carregados de soja. Quando subimos, ele já estava parado na estação de Sumaré e, ao partir, já estava saindo da estação. Agora, o estrago estava feito e era hora de pensar numa solução.</p>
                <p>Pensei comigo: "Vou esperar uns 20 minutos até a próxima estação e ligo para o meu primo, para ele vir me buscar com alguém; assim, dará tempo para que ele chegue na casa do meu tio e resolva isso." (Graças a Deus, naquela época, os celulares da Nokia tinham bateria que durava uns cinco dias; afinal, era só para ligações, SMS e o jogo da cobrinha. Alguém se lembra disso?) Mas, voltando... Passados vinte minutos, liguei e perguntei ao meu primo. (Diga-se de passagem, ele ficou o tempo todo ao lado do telefone para atender prontamente e não outra pessoa. Logo vocês entenderão o motivo dessa "gentileza".) Toda vez que eu ligava para a casa dos meus avós, ele dizia que já estavam resolvendo e que tinha contado para minha família. Fiquei mais tranquilo, mas, quando o trem passou direto pela próxima cidade, que me lembro vagamente de ter o nome de... Santa Gertrudes, liguei novamente desesperado. Segurando o celular com uma mão e a outra na escada, gritei: Eu: "- Primo, o trem não parou! Passou direto por uma cidade chamada Santa Gertrudes. Onde estou?" Ele respondeu que iria desligar e já me ligaria de volta. (Acho que é porque alguém estava ao lado dele e não poderia ouvir a conversa, pensando com outra visão nos dias de hoje.) Aguardei dez minutos e nada dele ligar. Enquanto isso, o trem passava por lugares desertos, por cima de pontes e sobre o rio; a tentação de pular no rio era enorme, mas, ao pensar na correnteza, a coragem desaparecia. Mantive-me no trem, pendurado por mais duas horas, e nada dele me ligar.</p>
                <p>Finalmente, liguei novamente e, para minha surpresa, quem atendeu foi minha tia. Ela disse: Tia: "- Oi, Dan (ela me chamava assim). Onde você está? Por que não voltou com o Ale da casa do seu tio? Que horas você vem?" (Pausa para entender o problema. Pela conversa dela, deu para notar que ela nem sabia do que estava acontecendo, certo?) Pois bem, a verdade era essa: meu primo chegou à casa da minha avó como se nada estivesse acontecendo. Tomou café, assistiu desenho, tomou banho... (Acho que, na inocência de criança, imaginou que ninguém notaria minha ausência.) Mas seu plano falhou quando liguei justamente enquanto ele estava no banho, e minha tia atendeu. Eu: "- Tia, cadê o Ale? Avisa para ele que já passei por outra cidade." (Mais uma pausa para descrever a situação. Até aquele momento, eu já havia passado pelas cidades de Santa Bárbara d'Oeste, Cordeirópolis, Santa Gertrudes e estava a caminho de Rio Claro, aproximadamente a 77 km de Sumaré. E, fora eu e meu primo, ninguém sabia de nada. Ele simplesmente chegou à casa da minha avó e agiu normalmente.) Quando minha tia descobriu, ficou desesperada. Disse que ia desligar e ver o que poderia fazer, pois ele não havia contado nada. Enquanto isso, eu, pendurado no trem, comecei a enfrentar uma chuva fria e um vento gelado. Meus dedos dos pés estavam dormentes e meus braços com cãibras por ficar tanto tempo em pé na escada do vagão, segurando há mais de quatro horas. Uma água suja escorria no meu corpo e rosto ("o que vim a descobrir depois ser resíduo da carga de soja").</p>
                <p>Após muito tempo, o trem passou por um conjunto de chácaras onde havia uma festa. Num ato de desespero, comecei a acenar e a gritar por socorro. Agora, vem a parte engraçada: ninguém conseguia ouvir o que eu falava; deduziram que eu estava apenas dando tchau lá de cima e começaram a acenar de volta; até ergueram uma criança para me ver no trem e também me dar tchau. Você consegue ter uma noção deste momento? Perdi as esperanças! Depois de quase quatro horas de viagem pendurado no trem e muito além de Rio Claro, o maquinista finalmente parou, e foi onde eu pulei e comecei a correr para o meio do mato, até encontrar a entrada de uma cidadezinha chamada Itirapina, a mais de 110 km de onde eu havia partido. Sujo, molhado, de chinelo Havaianas, calça florida e camiseta regata branca, encharcada de caldo preto. Cheguei na rodoviária e liguei para... meus avós de um orelhão, pois meu celular já estava sem bateria. Minha tia atendeu e disse: Tia: "- Dan, onde você está? Consegui falar na estação, e estão tentando contatar o maquinista para parar o trem. Avisei que tem uma criança pendurada no vagão." Eu: "- O trem parou, tia. Eu desci em uma cidade chamada Itirapina. Não tenho um centavo no bolso, nem passagem, nem nada."</p>
                <p>Minha tia disse que falaria com meu tio para ir me buscar. Por volta das 22h, ele chegou e, claro, levei uma bronca enorme. Minha mãe me avisou que o trem levava carga de soja com destino ao Mato Grosso do Sul e que não pararia até chegar lá. Só parou porque minha tia conseguiu falar na estação. A vida é bela, não? Meu primo teve a "brilhante" ideia de cortar caminho pelo trilho, depois de subir no trem para ser mais rápido, pular e quase morrer. No final, ele só me deixaria ir para o Mato Grosso do Sul e, em sua mente genial, ninguém jamais sentiria minha falta. Isso serviu para eu aprender: nunca se deve ignorar os próprios instintos e acreditar cegamente nas conversas das pessoas. Desde esse dia, não aceitei mais nenhuma ideia "genial" do meu primo. Bom, ele levou uma bronca pela "cagada que fez, e eu fiquei de castigo. Acho que agora vocês já conhecem um pouco mais da minha infância raiz e das aventuras que passei. Vamos falar de outros traumas, agora alguns amorosos; afinal, nem tudo é partir em um trem rumo ao desconhecido. Que tal irmos para o próximo capítulo?</p>
            </div>
        </div>
    </div>

    <!-- Modal Cap 3 -->
    <div id="modal-cap3" class="chapter-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">CAPÍTULO 3</p>
                    <h3 class="text-white font-serif text-xl">LEMBRANÇAS ESCOLARES</h3>
                </div>
                <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-cap3')"></i>
            </div>
            <div class="modal-body">
                <p>Neste capítulo, recordo-me vagamente de alguns momentos na escola. Confesso que nunca fui muito popular e também não tinha jeito com as meninas. Éramos daquela turminha de meninos bobões e inocentes. Alguns momentos, porém, foram marcantes, como quando íamos para a escola acho que eu estava na sétima série - e, na hora da saída, havia um senhor que vendia chup-chup (mais conhecido hoje como geladinho ou sacolé). Lembro que ele usava óculos de aviador e tinha um bigodão, muito estranho para a época, mas gostávamos dele porque dava para trocar chup-chup por nossos passes de ônibus para depois irmos embora a pé. Parecia uma ideia genial para uma criança, mesmo que o caminho de casa fosse muito longo para ir a pé.</p>
                <p>Nessa mesma época, comprávamos um saco enorme de salgadinhos de 1 kg para comermos na escola escondidos na hora do intervalo. Esperávamos todos saírem da sala para fechar a porta. O problema era quando alguém descobria; naquela época, as crianças eram meio "zumbis" com fome e não podiam ver você comendo algo que desejavam a qualquer custo. Lembro de nós segurando a porta com toda a força, enquanto tentavam abri-la a chutes, e meu amigo falava: "Come logo, come logo!", enquanto tentávamos manter a porta fechada. Aguentávamos o máximo possível, pois às vezes se juntavam quatro ou cinco moleques chutando do outro lado. Quando conseguiam abrir, era motivo para perder a amizade por alguns dias. Depois de isso acontecer umas cinco vezes, na hora do recreio ninguém mais saía da sala antes de revistar minha bolsa ou a do meu amigo, só para ter certeza de que não tínhamos salgadinho e não iríamos comer escondido deles. Pois é, como dizem, o crime não compensa, né?</p>
                <p>Nessa época, eu era apaixonado por uma menina chamada Gisele. Ela era um pouco popular e nem de longe daria bola para um cara nada popular como eu, que lutava por um salgadinho de 1 kg de cinquenta centavos na hora do recreio. Lembro-me também de que toda turma sempre tem o garoto popular, aquele que gosta de bater nas pessoas, que joga bola muito bem comparado a outros que não jogam nada, né? Minha turma também tinha alguns assim naquela época, e hoje a Gisele, com certeza, já é mãe do filho de um deles, que, por sinal, ela engravidou naquela época.</p>
                <p>Mas, fora a vida amorosa escolar, sempre fui alguém que os professores e diretores tratavam bem, e isso até que era bom. Depois de finalizar a oitava série nesta escola, mudei para outra, onde estudava meu melhor amigo da minha rua. Era um lugar bom, mas as brincadeiras da época, que permitiam dentro da escola, hoje assustariam qualquer um. Na hora do intervalo, sempre brincávamos de "passou levou". Você deve imaginar pelo nome que não é nada carinhoso; pois é, a brincadeira consistia em amassar uma latinha de refrigerante e ter um pique para se salvar, e viver com as pernas fechadas. Caso aquela simples latinha passasse entre suas pernas, o objetivo de todos ali brincando era te arrebentar na porrada até você conseguir chegar no pique. Sinceramente, ninguém naquela época tinha dó para medir forças. Lembro-me de apanhar muito; inclusive, um amigo chegou a levar um chute na barriga e ficou sem ar. Mas todo mundo saiu salvo e sem sequelas; pode até sair dolorido e roxo, mas todos vivos até então.</p>
                <p>Coisas de criança raiz! E depois dizem que celulares não salvam vidas, né? Hoje, as crianças nem imaginam brincar assim; se alguma levar um chute, com certeza vai parar no hospital. Podemos dizer que minha geração era a geração "família busca pé". Isso foi em torno do primeiro ano do ginásio ou algo assim; só fui me tornar um pouco mais popular no segundo ou terceiro ano. Ali já tinha o respeito da galerinha "do mal" da escola. Eu era um pouco nerd, e poucas pessoas sabiam desenhar ou montar um site naquela época. Criei um site para minha turma, que logo ficou conhecido na escola inteira. Até mesmo os diretores e professores sabiam da existência dele, claro, com um conteúdo bem inútil, diga-se de passagem. Mas serviu para me deixar, a mim e a meus amigos, bem famosos na escola, e ali começaram a aparecer alguns casos amorosos dos quais eu viria a me arrepender um pouco mais tarde.</p>
                <p>Ainda assim, não tinha muito jeito para conquistar as garotas; tanto que, de uma delas, por quem eu era apaixonado na época, acabei levando um fora ao tentar conquistá-la com um buquê de flores. No final, um garoto que vivia com as calças caídas no meio da bunda, no estilo "malaco", garoto este que apelidamos entre nossa turminha de "cara de burquinha", acabou namorando com ela e a engravidando. Acho que era tipo uma "maldição" para quem me desse um fora: se não ficasse comigo, ia engravidar de um "tranqueira". Filhos não são maldições, é apenas um modo de ilustrar sobre levar um fora e o pai acabar sendo outro e "metido a bandido". E assim foi a minha vida escolar. Ah, já estava quase me esquecendo: a camiseta de formatura da escola fui eu quem desenhou. Nessa época, acho que até tinha dom para algumas coisas. Lembro-me também de pegar uma máquina fotográfica velha da minha irmã ("naquela época, as máquinas eram de filme ainda"). Acho que metade das pessoas que ouvirem isso nunca vai imaginar como funciona. Explicando de uma forma mais grosseira: você comprava um filme para 12, 24 ou 36 poses e tinha direito a tirar essa quantidade de fotos. Você não fazia ideia de como sairia nas fotos até o dia de revelar. Tirar foto naquela época era muito emocionante; a expectativa de revelar era tão grande que fazíamos "vaquinha" para levar ao fotógrafo. ("Você não fazia isso na sua casa; tinha que ser um especialista.") Quando recebia as fotos, todos queriam ver e pediam uma cópia, a qual apenas o fotógrafo poderia fazer com o mesmo negativo. Era muito legal, uma época em que as pessoas davam valor às mínimas coisas. Tanto que quem é dessa época tem poucas fotos, mas guardadas em seu armário por toda a vida, enquanto nos dias de hoje, há milhares de fotos a cada segundo, e a pessoa nem liga se perder algumas delas. Ficou tudo muito banal e superficial, ainda mais com a chegada das tais redes sociais. No último ano escolar, comecei a namorar, mas deixarei isso para o próximo capítulo.</p>
            </div>
        </div>
    </div>

    <!-- Modal Cap 4 -->
    <div id="modal-cap4" class="chapter-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div>
                    <p class="text-gold text-[10px] font-bold uppercase tracking-widest">CAPÍTULO 4</p>
                    <h3 class="text-white font-serif text-xl">O ENCONTRO QUE MUDARIA TUDO</h3>
                </div>
                <i data-lucide="x" class="w-6 h-6 close-btn" onclick="closeModal('modal-cap4')"></i>
            </div>
            <div class="modal-body">
                <p>Continuando a parte do último ano escolar, ali comecei a cultivar relacionamentos um pouco mais duradouros. Mas não foi pela escola ou pelas amigas que realmente me envolvi com alguém. Naquela época, não havia redes sociais ou aplicativos de relacionamento. Você entrava em um chat com internet discada. Sim, tínhamos internet discada, e quem viveu esse tempo lembra-se do barulhinho da internet se conectando. O problema é que a internet era conectada ao fio do telefone e, quando se estava online, ninguém conseguia ligar; o telefone ficava mudo, fazendo um barulho horrível. Assim, você era facilmente pego pelos seus pais na internet, mesmo fingindo estar dormindo. Quantas vezes não criei a estratégia de fingir que estava dormindo e, quando meus pais iam dormir, eu acessava a internet e ficava em chats de amizade e relacionamento conversando com as pessoas? E quantas vezes meu pai, já conhecendo meu truque, não acordou de madrugada, pegou o telefone na sala e viu que eu estava conectado? Aí ele subia para o quarto, batia na porta, eu desligava o computador correndo e fingia dormir. Ele ia lá e arrancava o fio do telefone do computador. Era complicada a vida da juventude dos anos 90; você achando que a vida é difícil agora, não é mesmo?</p>
                <p>Dessas inúmeras vezes, lembro-me de conhecer uma garota com quem comecei a trocar ideia. Naquela época, você tinha que ser bom no "xaveco ; não havia como ficar postando fotos de viagens ou carrões. Imagina ter um carrão, então? Você fazia encontros às escuras, marcava com a pessoa e ia conhecê-la na hora. Quem viveu esse tempo vai se lembrar: toda garota com quem você conversava era morena de olhos verdes ou loira de olhos azuis. Acho que foi a partir dessa época que começaram a existir os filtros imaginários das redes sociais de hoje. Pois bem, depois de alguns encontros, realmente conheci uma garota com um nome estranho, que não citarei aqui, mas ela realmente tinha olhos azuis; só não era loira, era até bem bonita. Um dia, conversando com ela, a prima também veio conversar conosco e, disso, pegou meu contato e começou a falar comigo sem contar para a garota. Inclusive, certo dia, ela veio até a minha casa me buscar de carro, e eu nem carro tinha na época. Saímos, nos conhecemos e acabamos nos beijando. Você nem imagina o tamanho da raiva que a prima dela ficou por ter sido "passada para trás".</p>
                <p>Desse relacionamento, acabamos nos conhecendo melhor e começamos a namorar. Foi um relacionamento bem duradouro, em média, acho que por três anos. Lembro-me de que o pai dela não gostava muito de mim. Não entendo o porquê, mas hoje, sendo pai, entendo que não gostaria de nenhum namorado da minha filha. Acho que isso desgastou um pouco nosso relacionamento até chegarmos ao término. Quando você não se envolve com a família, não se sente bem-vindo onde está; isso influencia bastante. Mudando um pouco de assunto, lembro-me de estarmos na rede da casa da minha namorada. Era uma parte alta, onde a garagem ficava na parte de baixo, e, de cima do muro, você podia ver a rua. Então, uma noite, deitados na rede e com meu carro na rua, um Uno ano 95 ("bom, não era bem meu, era da minha irmã, mas ela deixava eu usar às vezes"), deitados na rede com sono, ouço uma buzina. Diga-se de passagem, era uma buzina muito parecida com a do meu carro. Levanto da rede e vou em direção ao muro olhar o carro. Quando olho, vejo as duas portas abertas e o farol aceso e penso: "Não acredito, deixei o carro com as portas abertas e o farol aceso." Muito lerdo, não é mesmo? Vejo umas perninhas mexendo dentro do carro e percebo que estão tentando roubar. E, como o Tarzan, grito alto: "Uouuuuu!" Os ladrões, sem entender nada, saem correndo desesperados. Pela primeira vez na história, alguém espanta ladrões no grito. Depois disso, nunca mais deixei o carro na rua.</p>
                <p>Namoramos por um bom tempo, sempre curtindo e saindo juntos. Ela vinha em casa, eu ia na casa dela. Lembro-me também de quando íamos a baladas; afinal, éramos jovens, meio que um Eduardo e Mônica da música do Legião Urbana. Ela fazia faculdade e tinha dinheiro, enquanto eu, "duro", não fazia faculdade. Eu precisava suprir essa diferença para poder acompanhar a vida de balada de um adolescente. E como eu poderia fazer isso sem gastar dinheiro? Aí começou meu primeiro empreendimento. Eu sabia fazer sites e tinha uma máquina digital, pois trabalhava na Microcamp de Sumaré com meu salário "milionário" de seiscentos e oitenta reais e sem registro. Meus dois primeiros salários foram para comprar uma máquina digital e um celular de modelo flip chamado Samsung Voicer. Eu já tinha tudo o que precisava; só precisava de dois amigos mais "vagas que adoravam balada e estava tudo perfeito. Montei um site, que na época chamei de Agito Noturno, e fomos às baladas oferecendo tirar fotos das festas e colocar no site gratuitamente, em troca de entrarmos nas baladas de graça e podermos beber à vontade.</p>
                <p>Confesso que aquela foi uma das melhores ideias da minha vida: não ter um tostão furado no bolso e poder sair de terça a domingo para baladas, além de várias pessoas te conhecerem e fazerem vários amigos e amigas. Agora, me diga: como alguém que entregava flores para uma menina da escola e levava fora chegou ao ponto de ficar famoso em baladas? Eu chegava ao local e os seguranças diziam: "Pode deixa entrar, é a galera do Agito Noturno, são gente boa." E curtíamos a festa o tempo todo. Eu ainda me sentia meio diferente; meus amigos aproveitavam para paquerar meninas e beber, enquanto eu, meio que inocentemente, levava aquilo a sério e mantinha o foco no trabalho. Sempre me senti alguém que não nasceu para trabalhar para os outros; também nunca fui bom o suficiente em qualquer coisa, sempre "quebrando o galho" e me virando. Mas, nessa época, eu era bem descolado, fazia amigos facilmente. Com o tempo, isso começou a virar um empecilho no meu namoro; meu sogro não aceitava, e hoje em dia concordo com ele. Mas acho que ele não entendia; eu via aquilo como uma mega corporação futuramente. O que, diga-se de passagem, não virou, mas não foi por falta de sonhar; foi exatamente porque virou "zona". Meus amigos só queriam bagunça e "pegar" a mulherada com a roupa do Agito Noturno. Resolvi parar com tudo, mas foi uma época maravilhosa.</p>
                <p>Chegávamos a ir até mesmo em camarotes de artistas famosos na época, como Fala Mansa ou cantoras internacionais que se apresentavam na balada mais "top" de Campinas, a antiga Usina Royal. Saíamos para baladas de graça todos os dias, e isso sendo "feios”... tá, não tão feio; era um rapaz que dava para o gasto na época, mas, como dizia um certo comercial, eu não era uma Brastemp, mas estava bom. Ali, em meio à vida de festas e dando aulas na Microcamp, onde muitas alunas tinham "tara" por professores, era difícil não cair em tentação, mas me mantive firme ainda assim. Até o dia em que vi a futura mãe da minha filha; ela tinha aulas de inglês aos domingos, e sim, eu tinha que trabalhar aos domingos na Microcamp. Vida de professor era só fachada; ganhava-se muito mal e tinha uma vida de cão. (Apenas uma pausa para ressalva: eu ia todos os dias de carro de Campinas para Sumaré, que era onde eu dava aula.) (Você pode ter uma noção do quanto sobrava do meu salário pagando a gasolina? Sim, eles não pagavam vale-transporte. Acho que me sobravam por mês uns quatrocentos reais para gastar comigo e meu namoro.)</p>
                <p>Mas, voltando para a parte de conhecer a mãe da minha filha. Não consigo explicar, mas quando a vi sorrindo através do vidro naquele domingo, foi amor à primeira vista. Acho que poucos vão saber o que é isso hoje em dia, mas foi algo que tirou o fôlego. Não entendo, não sei explicar, mas, da mesma forma que me apaixonei por ela naquele momento, ela também se apaixonou por mim. Foi um encontro de almas gêmeas, se isso existir. Mas como resolver o problema do meu namoro atual a esta altura do campeonato? Já não sentia mais o que sentia antigamente; o namoro já estava desgastado antes mesmo de conhecer Camila. Depois de um tempo, resolvi terminar com minha namorada e tentar a sorte com aquela por quem me apaixonei instantaneamente. Certo dia, pedi à professora que falasse com sua aluna e dissesse que eu gostava dela e, para minha surpresa, a professora disse que sua aluna também estava sempre me olhando e queria me conhecer. Naquele mesmo dia, pedi que ela não fosse embora e ficasse ali para conversarmos. Com cinco minutos de conversa, não me aguentei e a agarrei na sala de reunião dos professores, beijando-a ali mesmo. Foi algo instintivo; nunca teria feito isso em toda a minha vida, mas foi mais forte.</p>
                <p>Ali começa realmente minha história de vida com a mãe da minha filha e mulher da minha vida: de um encontro em pleno domingo, sem qualquer propósito, e de um beijo que marcou os dois. É louco pensar nisso neste momento. Lembro-me da cena até hoje, lembro-me do gosto dos lábios dela beijando os meus. Confesso que bate uma angústia em saber que não terei a oportunidade de sentir seus beijos novamente, e o quanto me faz falta hoje. Aquele simples beijo gerou uma vida com dezesseis anos de relacionamento, destes, quatro sendo viúvo. Escrevo isso quase chorando, peço desculpas se esta parte ficar um pouco sentimental. A partir daquele dia, senti que algo havia realmente mudado na minha vida. Eu pensava nela o dia todo, queria falar com ela o tempo todo. Falávamos por horas ao telefone, e ali ficava a outra parte do meu salário que não ia para a gasolina; servia para pagar parte da conta de telefone para o meu pai. Lembro-me de colocar músicas românticas para ela ao telefone, como Creed, entre outras. Era um namoro tão diferente de tudo que vivi até aqueles dias, e tenho certeza de que nunca conseguirei viver novamente. Confesso que é um buraco no coração que somente a presença da minha filha consegue tampar às vezes.</p>
                <p>Lembro-me de sempre ir buscá-la no meu horário de saída; íamos a um condomínio de um amigo do trabalho, onde havia uma pracinha. Ficávamos ali por horas abraçados, fazendo planos sem nenhum centavo no bolso. Quando íamos embora e eu estava de carro, sempre tinha uma cena muito engraçada; não imagino como ela não ficou careca. Pois é, sem eu perceber, enquanto me beijava, ela aproveitava para tirar fios de seu cabelo e jogar por todas as partes do meu carro. ("Eu sempre estranhei achar cabelos dela do nada mesmo, mas nunca liguei muito.") Até que, um dia, ela me contou que fazia isso e explicou que, se eu estivesse mentindo, que eu não tinha namorada além dela, era para eu me "ferrar". Foram os melhores momentos da minha vida. Certa vez, lembro-me, em um domingo de muito sol e calor, estávamos lá, neste condomínio, na pracinha, namorando, quando falei para irmos tomar um sorvete. Ela aceitou meu convite e, então, fomos para a padaria. Chegando à padaria, pedi que escolhesse o sorvete que desejasse. Ela pegou um sorvete que custava apenas um real, o mais barato de todos. No momento, fiquei indignado e falei para que escolhesse outro mais caro. Ela me disse que sorvete era tudo igual e que servia apenas para refrescar do calor. Disfarçadamente, abri minha carteira para ver quanto dinheiro eu tinha, pois minha intensão era trocar o sorvete dela pelo mais caro. Para minha surpresa, em meio a tanto amor, esqueci que eu era um professor de informática que ganhava um salário horrível. Naquele dia, eu tinha apenas um real e cinquenta centavos na carteira. Ela me perguntou: "- E você, qual vai pegar? Vai pegar o mais caro mesmo?" Olhei para ela e disse: "Quer saber? Não estou com calor. Vou levar só o seu mesmo." Peguei dos meus um real e cinquenta centavos, o valor de um real, e paguei o sorvete. Agradeci a Deus por ela ser quem era, o que me poupou de uma grande vergonha naquele dia. Foi o momento mais marcante da minha vida. Ali vi que havia conhecido a mãe da minha filha e o amor da minha vida. Mas, mais uma vez, os problemas com os sogros surgiram como um obstáculo. Eles não gostavam de mim porque o ex dela vivia indo à casa deles, dizendo que estava sofrendo e queria reatar. De alguma forma, o pai dela descobriu meu número de telefone. Mas essa história fica para o próximo capítulo.</p>
            </div>
        </div>
    </div>

    <!-- Biblioteca AOS JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
// --- CONFIGURAÇÃO DO FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyBbdp4ugMhLTcU6z0jxsF865FGwI0ypnEw",
            authDomain: "eu-existo-por-voce.firebaseapp.com",
            projectId: "eu-existo-por-voce",
            storageBucket: "eu-existo-por-voce.firebasestorage.app",
            messagingSenderId: "107312377850",
            appId: "1:107312377850:web:a60f415e6d2aeabe90be43"
        };

        // Inicializa Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- VARIÁVEIS GLOBAIS ---
        let currentUser = null;
        let currentProductAmount = 64.69;
        let currentProductName = 'Livro Físico';
        let currentStep = 1;
        let isRegistering = true;

        // --- LINKS REAIS (Configure aqui) ---
        const LINK_PAGAMENTO_LIVRO = "https://link.mercadopago.com.br/SEU_LINK_LIVRO_AQUI"; 
        const LINK_PAGAMENTO_EBOOK = "https://link.mercadopago.com.br/SEU_LINK_EBOOK_AQUI";
        const FORMSPREE_ENDPOINT = "https://formspree.io/f/SEU_CODIGO_AQUI"; 

        // --- VERIFICAÇÃO DE LOGIN E ADMIN ---
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                document.getElementById('btn-account').classList.remove('hidden');
                // Verifica se é ADMIN
                db.collection('users').doc(user.uid).get().then(doc => {
                    if (doc.exists && doc.data().role === 'admin') {
                        document.getElementById('btn-admin').classList.remove('hidden');
                    }
                });
            } else {
                currentUser = null;
                document.getElementById('btn-account').classList.add('hidden');
                document.getElementById('btn-admin').classList.add('hidden');
            }
        });

        // --- FUNÇÕES DE PAGAMENTO E COMPRA ---
        function checkLoginAndBuy(type) {
            if (type === 'printed') {
                currentProductAmount = 64.69;
                currentProductName = "Livro Físico + Audio Book";
            } else {
                currentProductAmount = 19.99;
                currentProductName = "E-book Digital + Audio Book";
            }

            if (currentUser) {
                processDirectPurchase(currentUser);
            } else {
                isRegistering = true;
                currentStep = 1;
                updateWizardUI();
                openModal('modal-auth');
            }
        }

        function processDirectPurchase(user) {
            // Salva intenção de compra e redireciona
            db.collection('checkout_attempts').add({
                email: user.email,
                name: user.displayName || 'Cliente',
                uid: user.uid,
                product: currentProductName,
                price: currentProductAmount,
                date: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'Aguardando Pagamento', 
                paymentMethod: 'Mercado Pago',
                tracking_code: ''
            }).then(() => {
                // Lógica de Redirecionamento
                if (currentProductName.includes("Físico")) {
                    // window.location.href = LINK_PAGAMENTO_LIVRO; // (Descomente para usar link real)
                    alert("Redirecionando para o Pagamento do Livro (Simulação)");
                } else {
                    // window.location.href = LINK_PAGAMENTO_EBOOK;
                    alert("Redirecionando para o Pagamento do E-book (Simulação)");
                }
            }).catch(err => alert("Erro ao processar: " + err.message));
        }

        function switchPrice(type) {
            currentProductAmount = type === 'printed' ? 64.69 : 19.99;
            currentProductName = type === 'printed' ? "Livro Físico" : "E-book";
            
            document.querySelectorAll('.price-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + type).classList.add('active');

            const title = document.getElementById('price-title');
            const old = document.getElementById('price-old');
            const current = document.getElementById('price-current');
            const btn = document.getElementById('price-btn');

            if (type === 'printed') {
                title.innerText = "LIVRO FÍSICO (CAPA FLEXÍVEL) + AUDIO BOOK";
                old.innerText = "109,83";
                current.innerText = "64,69";
                btn.innerText = "QUERO MEU LIVRO FÍSICO!";
                // Recria os features do físico
                document.getElementById('price-features').innerHTML = `
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Livro Impresso (Capa Flexível)</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Audio Book Narrado (Bônus)</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Entrega via Correios</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="gift" class="w-5 h-5 text-gold"></i> Marcador de Páginas Exclusivo</p>
                `;
            } else {
                title.innerText = "E-BOOK COMPLETO + AUDIO BOOK";
                old.innerText = "39,99";
                current.innerText = "19,99";
                btn.innerText = "QUERO MEU E-BOOK!";
                // Recria os features do digital
                document.getElementById('price-features').innerHTML = `
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Livro Digital (PDF/EPUB)</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Audio Book Narrado</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Entrega Imediata por E-mail</p>
                    <p class="flex items-center gap-3 text-sm text-gray-300"><i data-lucide="check-circle" class="w-5 h-5 text-gold"></i> Sem Custo de Frete</p>
                `;
            }
            btn.setAttribute('onclick', `checkLoginAndBuy('${type}')`);
            lucide.createIcons();
        }

        // --- WIZARD DE CADASTRO (3 PASSOS) ---
        function toggleAuthMode() {
            isRegistering = !isRegistering;
            currentStep = 1;
            updateWizardUI();
        }

        function updateWizardUI() {
            const els = ['step-1', 'step-2', 'step-3', 'btn-next', 'btn-submit', 'btn-login-action', 'login-fields', 'register-step-1'];
            els.forEach(id => document.getElementById(id)?.classList.add('hidden'));

            const title = document.getElementById('auth-title');
            const indicator = document.getElementById('wizard-step-indicator');
            const switchText = document.getElementById('auth-switch-text');

            if (!isRegistering) {
                // LOGIN
                document.getElementById('step-1').classList.remove('hidden');
                document.getElementById('login-fields').classList.remove('hidden');
                document.getElementById('btn-login-action').classList.remove('hidden');
                title.innerText = "FAZER LOGIN";
                indicator.innerText = "ACESSO";
                switchText.innerText = "Não tem conta? Criar agora";
            } else {
                // CADASTRO
                switchText.innerText = "Já tem conta? Fazer Login";
                title.innerText = "CRIAR CONTA";
                if (currentStep === 1) {
                    document.getElementById('step-1').classList.remove('hidden');
                    document.getElementById('register-step-1').classList.remove('hidden');
                    document.getElementById('btn-next').classList.remove('hidden');
                    indicator.innerText = "PASSO 1 DE 3: CONTA";
                } else if (currentStep === 2) {
                    document.getElementById('step-2').classList.remove('hidden');
                    document.getElementById('btn-next').classList.remove('hidden');
                    indicator.innerText = "PASSO 2 DE 3: CONTATO";
                } else if (currentStep === 3) {
                    document.getElementById('step-3').classList.remove('hidden');
                    document.getElementById('btn-submit').classList.remove('hidden');
                    indicator.innerText = "PASSO 3 DE 3: ENDEREÇO";
                }
            }
        }

        function nextStep() {
            // Validação simples
            if(currentStep === 1) {
                if(!document.getElementById('reg-email').value || !document.getElementById('reg-password').value) return alert("Preencha email e senha.");
            }
            if(currentStep === 2) {
                if(!document.getElementById('reg-cpf').value || !document.getElementById('reg-phone').value) return alert("CPF e Telefone são necessários.");
            }
            currentStep++;
            updateWizardUI();
        }

        function buscarEndereco(cep) {
            cep = cep.replace(/\D/g, '');
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`).then(r=>r.json()).then(data => {
                    if(!data.erro) {
                        document.getElementById('reg-street').value = data.logradouro;
                        document.getElementById('reg-district').value = data.bairro;
                        document.getElementById('reg-city').value = data.localidade;
                        document.getElementById('reg-state').value = data.uf;
                        document.getElementById('reg-number').focus();
                    }
                });
            }
        }

        function handleAuthSubmit(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-submit');
            btn.innerText = "CADASTRANDO...";
            
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const userData = {
                name: document.getElementById('reg-name').value,
                email: email,
                cpf: document.getElementById('reg-cpf').value,
                phone: document.getElementById('reg-phone').value,
                whatsapp: document.getElementById('reg-whatsapp').value,
                address: {
                    cep: document.getElementById('reg-cep').value,
                    street: document.getElementById('reg-street').value,
                    number: document.getElementById('reg-number').value,
                    comp: document.getElementById('reg-comp').value,
                    district: document.getElementById('reg-district').value,
                    city: document.getElementById('reg-city').value,
                    state: document.getElementById('reg-state').value
                },
                role: 'user',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };

            auth.createUserWithEmailAndPassword(email, password).then(cred => {
                return db.collection('users').doc(cred.user.uid).set(userData).then(() => {
                    cred.user.updateProfile({displayName: userData.name});
                    // Envio Formspree
                    fetch(FORMSPREE_ENDPOINT, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(userData) }).catch(e=>console.log(e));
                    
                    alert("Sucesso!");
                    closeModal('modal-auth');
                    processDirectPurchase(cred.user);
                });
            }).catch(err => {
                alert(err.message);
                btn.innerText = "FINALIZAR";
            });
        }

        function performLogin() {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-password').value;
            auth.signInWithEmailAndPassword(email, pass).then(cred => {
                closeModal('modal-auth');
                processDirectPurchase(cred.user);
            }).catch(err => alert("Erro login: " + err.message));
        }

        // --- PAINEL DO USUÁRIO (PERFIL) ---
        function openAccount() {
            if(!currentUser) return;
            openModal('modal-account');
            document.getElementById('user-name-display').innerText = currentUser.displayName || "CLIENTE";
            switchUserTab('orders');
        }

        function switchUserTab(tab) {
            const orderTab = document.getElementById('tab-user-orders');
            const dataTab = document.getElementById('tab-user-data');
            const btnOrders = document.getElementById('btn-tab-orders');
            const btnData = document.getElementById('btn-tab-data');

            orderTab.classList.add('hidden');
            dataTab.classList.add('hidden');
            
            // Reset estilos
            const inactiveClass = "text-left px-4 py-3 rounded text-sm font-bold text-gray-400 hover:text-white hover:bg-[#111625] transition-colors flex items-center gap-2";
            const activeClass = "text-left px-4 py-3 rounded text-sm font-bold bg-[#111625] text-gold border border-gold/30 hover:bg-[#1a2030] transition-colors flex items-center gap-2";

            btnOrders.className = inactiveClass;
            btnData.className = inactiveClass;

            if(tab === 'orders') {
                orderTab.classList.remove('hidden');
                btnOrders.className = activeClass;
                loadUserOrders();
            } else {
                dataTab.classList.remove('hidden');
                btnData.className = activeClass;
                loadUserProfileData();
            }
        }

        function loadUserOrders() {
            const list = document.getElementById('account-orders-list');
            list.innerHTML = '<p class="text-gray-500 text-center">Carregando...</p>';
            
            db.collection('checkout_attempts').where('email', '==', currentUser.email).orderBy('date', 'desc').get().then(snap => {
                if(snap.empty) { list.innerHTML = '<p class="text-gray-400 text-center">Nenhum pedido.</p>'; return; }
                let html = '';
                snap.forEach(doc => {
                    const d = doc.data();
                    const date = d.date ? new Date(d.date.seconds*1000).toLocaleDateString() : '-';
                    let color = 'text-yellow-500';
                    if(d.status?.includes('Aprovado') || d.status?.includes('Entregue')) color = 'text-green-500';
                    
                    html += `
                    <div onclick="showOrderDetails('${doc.id}')" class="bg-[#111625] border border-gray-800 p-4 rounded cursor-pointer hover:border-gold/50 transition-all group">
                        <div class="flex justify-between items-center">
                            <div><p class="text-white font-bold text-sm">${d.product}</p><p class="text-xs text-gray-500">#${doc.id.substr(0,8)} • ${date}</p></div>
                            <div class="text-right"><p class="text-xs font-bold uppercase ${color} mb-1">${d.status || 'Pendente'}</p><p class="text-xs text-gray-400">Ver <i data-lucide="chevron-right" class="w-3 h-3 inline"></i></p></div>
                        </div>
                    </div>`;
                });
                list.innerHTML = html;
                lucide.createIcons();
            });
        }

        function showOrderDetails(id) {
            const view = document.getElementById('order-details-view');
            const content = document.getElementById('order-details-content');
            view.classList.remove('hidden');
            content.innerHTML = '<p class="text-gold text-center">Carregando...</p>';

            db.collection('checkout_attempts').doc(id).get().then(doc => {
                if(!doc.exists) return;
                const d = doc.data();
                const status = d.status || 'Pendente';
                
                // Timeline Logic
                let step = 1;
                if(['Pagamento Aprovado', 'Fabricação Finalizada'].some(s => status.includes(s))) step = 2;
                if(status.includes('Expedição')) step = 3;
                if(status.includes('Coletado') || status.includes('Saiu')) step = 4;
                if(status.includes('Entregue')) step = 5;

                let timeline = `<div class="flex justify-between items-center relative mb-8 px-2">
                    <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-800 -z-0"></div>
                    <div class="absolute top-1/2 left-0 h-1 bg-gradient-to-r from-gold to-yellow-600 -z-0 transition-all" style="width: ${((step-1)/4)*100}%"></div>`;
                
                const icons = ['shopping-cart', 'hammer', 'package', 'truck', 'check-circle'];
                const labels = ['Pedido', 'Produção', 'Expedição', 'Transporte', 'Entregue'];
                
                icons.forEach((icon, i) => {
                    const active = i+1 <= step;
                    timeline += `
                    <div class="flex flex-col items-center gap-2 z-10">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center border-2 ${active ? 'bg-gold border-gold text-black' : 'bg-[#0B0F19] border-gray-600 text-gray-600'}"><i data-lucide="${icon}" class="w-4 h-4"></i></div>
                        <span class="text-[9px] uppercase ${active ? 'text-gold' : 'text-gray-600'}">${labels[i]}</span>
                    </div>`;
                });
                timeline += `</div>`;

                let trackHtml = '';
                if(d.tracking_code) {
                    trackHtml = `<div class="bg-[#111625] border border-gold/30 p-4 rounded mb-6 text-center"><p class="text-xs text-gray-400 uppercase">Rastreio</p><p class="text-xl text-white font-bold select-all">${d.tracking_code}</p><a href="https://www.melhorrastreio.com.br/rastreio/${d.tracking_code}" target="_blank" class="text-[10px] text-gold underline block mt-2">RASTREAR</a></div>`;
                }

                content.innerHTML = `
                    <div class="text-center mb-6"><p class="text-gray-400 text-xs uppercase">Status</p><h2 class="text-2xl text-gold font-serif font-bold">${status}</h2></div>
                    ${timeline}
                    ${trackHtml}
                    <div class="bg-[#111625] p-4 rounded border border-gray-800 space-y-2">
                        <div class="flex justify-between text-sm"><span class="text-gray-400">Produto:</span> <span class="text-white">${d.product}</span></div>
                        <div class="flex justify-between text-sm"><span class="text-gray-400">Valor:</span> <span class="text-gold">R$ ${d.price}</span></div>
                    </div>
                `;
                lucide.createIcons();
            });
        }

        function hideOrderDetails() { document.getElementById('order-details-view').classList.add('hidden'); }

        function loadUserProfileData() {
            if(!currentUser) return;
            db.collection('users').doc(currentUser.uid).get().then(doc => {
                if(doc.exists) {
                    const d = doc.data();
                    document.getElementById('profile-name').value = d.name || '';
                    document.getElementById('profile-email').value = d.email || currentUser.email;
                    document.getElementById('profile-phone').value = d.phone || '';
                    document.getElementById('profile-cpf').value = d.cpf || '';
                    document.getElementById('profile-address').value = d.address ? (typeof d.address === 'object' ? `${d.address.street}, ${d.address.number} - ${d.address.city}/${d.address.state}` : d.address) : '';
                }
            });
        }

        function saveUserData(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            btn.innerText = "SALVANDO...";
            const data = {
                name: document.getElementById('profile-name').value,
                phone: document.getElementById('profile-phone').value,
                cpf: document.getElementById('profile-cpf').value,
                address: document.getElementById('profile-address').value
            };
            db.collection('users').doc(currentUser.uid).set(data, {merge: true}).then(() => {
                alert("Salvo!");
                btn.innerText = "SALVAR ALTERAÇÕES";
            });
        }

        // --- ADMINISTRAÇÃO ---
        let adminCache = { orders: [], clients: [] };

        function openAdminPanel() {
            openModal('modal-admin');
            switchAdminTab('orders');
        }

        function switchAdminTab(tab) {
            const orderView = document.getElementById('admin-view-orders');
            const clientView = document.getElementById('admin-view-clients');
            const btnOrder = document.getElementById('adm-tab-orders');
            const btnClient = document.getElementById('adm-tab-clients');

            orderView.classList.add('hidden');
            clientView.classList.add('hidden');
            btnOrder.className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-transparent text-gray-500 hover:text-white';
            btnClient.className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-transparent text-gray-500 hover:text-white';

            if(tab === 'orders') {
                orderView.classList.remove('hidden');
                btnOrder.className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-red-500 text-white bg-red-900/10';
                loadAdminOrders();
            } else {
                clientView.classList.remove('hidden');
                btnClient.className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-red-500 text-white bg-red-900/10';
                loadAdminClients();
            }
        }

        function loadAdminOrders() {
            const list = document.getElementById('admin-orders-list');
            list.innerHTML = '<p class="text-center text-gray-500">Carregando...</p>';
            db.collection('checkout_attempts').orderBy('date', 'desc').get().then(snap => {
                adminCache.orders = [];
                snap.forEach(d => adminCache.orders.push({id: d.id, ...d.data()}));
                renderAdminOrders(adminCache.orders);
            });
        }

        function renderAdminOrders(orders) {
            const list = document.getElementById('admin-orders-list');
            if(!orders.length) { list.innerHTML = '<p class="text-center text-gray-500">Nada.</p>'; return; }
            
            let html = '';
            const statuses = ['Pedido Realizado', 'Aguardando Pagamento', 'Pagamento Aprovado', 'Pedido em Fabricação', 'Fabricação Finalizada', 'Pedido na Expedição', 'Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue', 'Pedido Cancelado'];
            
            orders.forEach(o => {
                const needsTrack = ['Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue'].includes(o.status);
                const opts = statuses.map(s => `<option value="${s}" ${o.status === s ? 'selected' : ''}>${s}</option>`).join('');
                
                html += `
                <div class="bg-[#111625] border border-gray-800 p-4 rounded hover:border-red-500/30 transition-colors">
                    <div class="flex flex-col md:flex-row justify-between gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1"><span class="text-[10px] bg-gray-800 px-2 rounded text-gray-300 font-mono">${o.id}</span><span class="text-gold font-bold text-xs">${o.product}</span></div>
                            <p class="text-white font-bold">${o.name||'Sem nome'}</p>
                            <p class="text-gray-400 text-xs">${o.email}</p>
                        </div>
                        <div class="flex flex-col gap-2 min-w-[200px]">
                            <select onchange="updateAdminOrderStatus('${o.id}', this.value)" class="bg-black border border-gray-700 text-white text-xs p-2 rounded outline-none">${opts}</select>
                            <div id="track-${o.id}" class="${needsTrack?'':'hidden'}">
                                <input type="text" placeholder="Rastreio" value="${o.tracking_code||''}" onblur="saveTracking('${o.id}', this.value)" class="w-full bg-[#0B0F19] border border-gold/30 text-gold text-xs p-2 rounded">
                            </div>
                            <div class="flex justify-end gap-2">
                                <button onclick="editOrderAdmin('${o.id}')" class="text-blue-400 p-2 hover:bg-blue-900/20 rounded"><i data-lucide="edit" class="w-4 h-4"></i></button>
                                <button onclick="deleteOrder('${o.id}')" class="text-red-500 p-2 hover:bg-red-900/20 rounded"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            list.innerHTML = html;
            lucide.createIcons();
        }

        function updateAdminOrderStatus(id, val) {
            const trackBox = document.getElementById(`track-${id}`);
            if(['Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue'].includes(val)) trackBox.classList.remove('hidden');
            else trackBox.classList.add('hidden');
            db.collection('checkout_attempts').doc(id).update({status: val});
        }

        function saveTracking(id, val) {
            if(val) db.collection('checkout_attempts').doc(id).update({tracking_code: val});
        }

        function editOrderAdmin(id) {
            const o = adminCache.orders.find(i => i.id === id);
            const name = prompt("Nome:", o.name);
            const email = prompt("Email:", o.email);
            if(name && email) {
                db.collection('checkout_attempts').doc(id).update({name, email}).then(()=>{ loadAdminOrders(); alert("Atualizado"); });
            }
        }

        function deleteOrder(id) {
            if(confirm("Deletar?")) db.collection('checkout_attempts').doc(id).delete().then(()=>loadAdminOrders());
        }

        // --- ADMIN: CLIENTES ---
        function loadAdminClients() {
            const list = document.getElementById('admin-clients-list');
            list.innerHTML = '<p class="text-center text-gray-500">Carregando...</p>';
            db.collection('users').get().then(snap => {
                adminCache.clients = [];
                snap.forEach(d => adminCache.clients.push({id: d.id, ...d.data()}));
                renderAdminClients(adminCache.clients);
            });
        }

        function renderAdminClients(clients) {
            const list = document.getElementById('admin-clients-list');
            if(!clients.length) { list.innerHTML = '<p>Nada.</p>'; return; }
            let html = '';
            clients.forEach(c => {
                html += `
                <div class="bg-[#111625] p-4 rounded border border-gray-800 flex justify-between items-center">
                    <div>
                        <p class="text-white font-bold text-sm uppercase">${c.name||'Sem nome'}</p>
                        <p class="text-gray-400 text-xs">${c.email}</p>
                        <p class="text-[10px] text-gray-600">Tel: ${c.phone||'-'}</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editClientAdmin('${c.id}')" class="text-blue-400 p-2 hover:bg-blue-900/20 rounded"><i data-lucide="edit" class="w-4 h-4"></i></button>
                        <button onclick="deleteUser('${c.id}')" class="text-red-500 p-2 hover:bg-red-900/20 rounded"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                    </div>
                </div>`;
            });
            list.innerHTML = html;
            lucide.createIcons();
        }

        function openAddClientModal() {
            const n = prompt("Nome:");
            const e = prompt("Email:");
            const p = prompt("Senha Provisória (min 6 chars):");
            if(n && e && p) {
                auth.createUserWithEmailAndPassword(e, p).then(cred => {
                    db.collection('users').doc(cred.user.uid).set({name: n, email: e, role: 'user', createdAt: new Date()})
                    .then(() => { alert("Cliente criado!"); loadAdminClients(); });
                }).catch(err => alert(err.message));
            }
        }

        function editClientAdmin(id) {
            const c = adminCache.clients.find(i => i.id === id);
            const n = prompt("Nome:", c.name);
            const p = prompt("Telefone:", c.phone);
            if(n) {
                db.collection('users').doc(id).update({name: n, phone: p}).then(()=>{ loadAdminClients(); alert("Atualizado"); });
            }
        }

        function deleteUser(id) {
            if(confirm("Deletar dados do cliente?")) db.collection('users').doc(id).delete().then(()=>loadAdminClients());
        }

        function filterAdminList(type) {
            const term = document.getElementById(type === 'order' ? 'admin-search-order' : 'admin-search-client').value.toLowerCase();
            if(type === 'order') {
                const f = adminCache.orders.filter(o => (o.email && o.email.toLowerCase().includes(term)) || (o.id.includes(term)));
                renderAdminOrders(f);
            } else {
                const f = adminCache.clients.filter(c => (c.email && c.email.toLowerCase().includes(term)) || (c.name && c.name.toLowerCase().includes(term)));
                renderAdminClients(f);
            }
        }

        // --- UTILS ---
        function logout() { auth.signOut().then(() => { closeModal('modal-account'); window.location.reload(); }); }
        function openModal(id) { 
            const m = document.getElementById(id); m.style.display='flex'; 
            setTimeout(()=>m.classList.add('open'),10); document.body.style.overflow='hidden'; 
        }
        function closeModal(id) { 
            const m = document.getElementById(id); m.classList.remove('open'); 
            setTimeout(()=>m.style.display='none',300); document.body.style.overflow='auto'; 
        }
        window.onclick = function(e) { if(e.target.classList.contains('chapter-modal') || e.target.classList.contains('auth-modal') || e.target.classList.contains('account-modal')) closeModal(e.target.id); }
        
        function switchTab(store, url, txt) {
            document.querySelectorAll('.market-tab').forEach(t=>t.classList.remove('active'));
            document.getElementById('tab-'+store).classList.add('active');
            const c = document.getElementById('market-btn-container');
            c.classList.remove('hidden'); c.classList.add('fade-in');
            document.getElementById('market-text').innerText = txt;
            document.getElementById('market-link').href = url;
        }

        // --- INICIALIZAÇÃO ---
        AOS.init({once: true, duration: 800});
        lucide.createIcons();
        switchPrice('printed');

        // Player
        const bgMusic = document.getElementById('bg-music');
        const player = document.getElementById('floating-player');
        const pIcon = document.getElementById('play-icon');
        let isPlaying = false;
        bgMusic.volume = 0.5;
        function toggleMusic() {
            if(isPlaying) { bgMusic.pause(); document.getElementById('music-status').innerText="Tocar Música"; pIcon.setAttribute('data-lucide','play'); player.classList.remove('music-playing'); isPlaying=false; }
            else { bgMusic.play().then(()=>{ document.getElementById('music-status').innerText="Pausar Música"; pIcon.setAttribute('data-lucide','pause'); player.classList.add('music-playing'); isPlaying=true; }).catch(e=>console.log(e)); }
            lucide.createIcons();
        }
        document.body.addEventListener('click', function(){ if(!isPlaying) toggleMusic(); }, {once:true});

        // Máscaras
        document.addEventListener('DOMContentLoaded', function () {
            if(document.getElementById('reg-phone')) IMask(document.getElementById('reg-phone'), { mask: '(00) 00000-0000' });
            if(document.getElementById('reg-whatsapp')) IMask(document.getElementById('reg-whatsapp'), { mask: '(00) 00000-0000' });
            if(document.getElementById('reg-cpf')) IMask(document.getElementById('reg-cpf'), { mask: '000.000.000-00' });
            if(document.getElementById('reg-cep')) IMask(document.getElementById('reg-cep'), { mask: '00000-000' });
            if(document.getElementById('profile-phone')) IMask(document.getElementById('profile-phone'), { mask: '(00) 00000-0000' });
            if(document.getElementById('profile-cpf')) IMask(document.getElementById('profile-cpf'), { mask: '000.000.000-00' });
        });

        // Player
        const bgMusic = document.getElementById('bg-music');
        const floatingPlayer = document.getElementById('floating-player');
        const musicStatus = document.getElementById('music-status');
        const playIcon = document.getElementById('play-icon');
        let isPlaying = false;
        bgMusic.volume = 0.5;

        function toggleMusic() {
            if (isPlaying) {
                bgMusic.pause();
                musicStatus.innerText = "Tocar Música";
                playIcon.setAttribute('data-lucide', 'play');
                floatingPlayer.classList.remove('music-playing');
                isPlaying = false;
            } else {
                bgMusic.play().then(() => {
                    musicStatus.innerText = "Pausar Música";
                    playIcon.setAttribute('data-lucide', 'pause');
                    floatingPlayer.classList.add('music-playing');
                    isPlaying = true;
                }).catch(() => console.log("Autoplay bloqueado."));
            }
            lucide.createIcons();
        }
        document.body.addEventListener('click', function() { if (!isPlaying) toggleMusic(); }, { once: true });

        // Preços
        function switchPrice(type) {
            currentProductName = type === 'printed' ? "Livro Físico" : "E-book";
            currentProductAmount = type === 'printed' ? 64.69 : 19.99;
            document.querySelectorAll('.price-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + type).classList.add('active');
            
            const title = document.getElementById('price-title');
            const old = document.getElementById('price-old');
            const current = document.getElementById('price-current');
            const btn = document.getElementById('price-btn');
            
            if (type === 'printed') {
                title.innerText = "LIVRO FÍSICO (CAPA FLEXÍVEL) + AUDIO BOOK";
                old.innerText = "109,83";
                current.innerText = "64,69";
                btn.innerText = "QUERO MEU LIVRO FÍSICO!";
            } else {
                title.innerText = "E-BOOK COMPLETO + AUDIO BOOK";
                old.innerText = "39,99";
                current.innerText = "19,99";
                btn.innerText = "QUERO MEU E-BOOK!";
            }
            btn.setAttribute('onclick', `checkLoginAndBuy('${type}')`);
        }
        switchPrice('printed');

        function switchTab(store, url, btnText) {
            document.querySelectorAll('.market-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + store).classList.add('active');
            const container = document.getElementById('market-btn-container');
            container.classList.remove('hidden');
            container.classList.add('fade-in');
            document.getElementById('market-text').innerText = btnText;
            document.getElementById('market-link').href = url;
        }

        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.classList.add('open');
            }, 10);
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('open');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
            document.body.style.overflow = 'auto';
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('chapter-modal') || 
                event.target.classList.contains('auth-modal') || 
                event.target.classList.contains('account-modal')) {
                closeModal(event.target.id);
            }
        }

        // Máscaras
        document.addEventListener('DOMContentLoaded', function () {
            if(document.getElementById('auth-phone')) {
                 IMask(document.getElementById('auth-phone'), { mask: '(00) 00000-0000' });
            }
            if(document.getElementById('auth-cpf')) {
                 IMask(document.getElementById('auth-cpf'), { mask: '000.000.000-00' });
            }
        });

// --- FUNÇÕES DO PAINEL ADMINISTRATIVO ---

let allOrdersCache = []; // Para guardar os pedidos e facilitar a busca

function openAdminPanel() {
    openModal('modal-admin');
    loadAllOrders();
}

function loadAllOrders() {
    const content = document.getElementById('admin-content');
    content.innerHTML = '<p class="text-gray-400 text-center">Carregando todos os pedidos...</p>';

    // Busca TODOS os pedidos na coleção checkout_attempts
    db.collection('checkout_attempts')
        .orderBy('date', 'desc')
        .get()
        .then(snapshot => {
            if (snapshot.empty) {
                content.innerHTML = '<p class="text-gray-400 text-center">Nenhum pedido encontrado.</p>';
                return;
            }

            allOrdersCache = [];
            let html = '';

            snapshot.forEach(doc => {
                const order = doc.data();
                const id = doc.id;
                // Salva no cache com ID
                allOrdersCache.push({ id, ...order });
                
                // Converte Data
                const date = order.date ? new Date(order.date.seconds * 1000).toLocaleString() : 'Sem data';
                
                // Define cor do status
                let statusColor = 'bg-yellow-600'; // Pendente
                if(order.status === 'Pago' || order.status === 'paid') statusColor = 'bg-green-600';
                if(order.status === 'Enviado') statusColor = 'bg-blue-600';
                if(order.status === 'Cancelado') statusColor = 'bg-red-600';

                // Status atual para o select
                const currentStatus = order.status || 'Pendente';

                html += `
                    <div class="bg-[#111625] border border-gray-800 p-4 rounded relative group hover:border-[#CBA135] transition-colors" id="card-${id}">
                        <div class="flex justify-between items-start gap-4 flex-wrap">
                            <div class="flex-1">
                                <p class="text-gold text-xs font-bold uppercase mb-1">${order.product || 'Produto Desconhecido'}</p>
                                <p class="text-white font-bold text-sm">${order.name || 'Sem Nome'}</p>
                                <p class="text-gray-400 text-xs">${order.email}</p>
                                <p class="text-gray-500 text-[10px] mt-1">ID: ${id} • ${date}</p>
                            </div>
                            
                            <div class="flex flex-col items-end gap-2">
                                <select onchange="updateOrderStatus('${id}', this.value)" class="bg-black border border-gray-600 text-white text-xs p-1 rounded cursor-pointer focus:border-gold outline-none">
                                    <option value="Pendente" ${currentStatus === 'Pendente' ? 'selected' : ''}>Pendente</option>
                                    <option value="Pago" ${currentStatus === 'Pago' ? 'selected' : ''}>Pago</option>
                                    <option value="Enviado" ${currentStatus === 'Enviado' ? 'selected' : ''}>Enviado</option>
                                    <option value="Entregue" ${currentStatus === 'Entregue' ? 'selected' : ''}>Entregue</option>
                                    <option value="Cancelado" ${currentStatus === 'Cancelado' ? 'selected' : ''}>Cancelado</option>
                                </select>

                                <p class="text-white font-bold text-sm">R$ ${order.price}</p>
                            </div>
                        </div>

                        <div class="mt-4 pt-3 border-t border-gray-800 flex justify-end gap-3">
                             <button onclick="editClientData('${id}')" class="text-blue-400 text-xs hover:text-white flex items-center gap-1">
                                <i data-lucide="edit" class="w-3 h-3"></i> Editar Dados
                            </button>
                            <button onclick="deleteOrder('${id}')" class="text-red-500 text-xs hover:text-red-300 flex items-center gap-1">
                                <i data-lucide="trash-2" class="w-3 h-3"></i> Deletar
                            </button>
                        </div>
                    </div>
                `;
            });

            content.innerHTML = html;
            lucide.createIcons();
        })
        .catch(err => {
            console.error(err);
            content.innerHTML = '<p class="text-red-500 text-center">Erro ao carregar.</p>';
        });
}

// Alterar Status
function updateOrderStatus(docId, newStatus) {
    db.collection('checkout_attempts').doc(docId).update({
        status: newStatus
    }).then(() => {
        // Feedback visual simples (piscar verde)
        const card = document.getElementById(`card-${docId}`);
        card.style.borderColor = '#22c55e';
        setTimeout(() => card.style.borderColor = '', 1000);
    }).catch(error => alert("Erro ao atualizar: " + error.message));
}

// Deletar Pedido
function deleteOrder(docId) {
    if(confirm("Tem certeza que deseja deletar este pedido permanentemente?")) {
        db.collection('checkout_attempts').doc(docId).delete().then(() => {
            document.getElementById(`card-${docId}`).remove();
        }).catch(error => alert("Erro ao deletar: " + error.message));
    }
}

// Editar Dados do Cliente (Nome/Email) - Simplificado usando Prompt
function editClientData(docId) {
    const order = allOrdersCache.find(o => o.id === docId);
    if(!order) return;

    const newName = prompt("Editar Nome do Cliente:", order.name);
    if (newName === null) return; // Cancelou

    const newEmail = prompt("Editar E-mail do Cliente:", order.email);
    if (newEmail === null) return;

    if(newName && newEmail) {
        db.collection('checkout_attempts').doc(docId).update({
            name: newName,
            email: newEmail
        }).then(() => {
            loadAllOrders(); // Recarrega para mostrar dados novos
            alert("Dados atualizados!");
        }).catch(err => alert("Erro: " + err.message));
    }
}


/* --- NOVA LÓGICA DE USUÁRIO E ADMINISTRAÇÃO --- */

// --- PERFIL DO USUÁRIO ---

function switchUserTab(tab) {
    document.getElementById('tab-user-orders').classList.add('hidden');
    document.getElementById('tab-user-data').classList.add('hidden');
    document.getElementById('btn-tab-orders').classList.replace('text-gold', 'text-gray-400');
    document.getElementById('btn-tab-orders').classList.replace('bg-[#111625]', 'hover:bg-[#111625]');
    document.getElementById('btn-tab-orders').classList.remove('border', 'border-gold/30');
    
    document.getElementById('btn-tab-data').classList.replace('text-gold', 'text-gray-400');
    document.getElementById('btn-tab-data').classList.remove('bg-[#111625]', 'border', 'border-gold/30');

    if (tab === 'orders') {
        document.getElementById('tab-user-orders').classList.remove('hidden');
        const btn = document.getElementById('btn-tab-orders');
        btn.classList.add('text-gold', 'bg-[#111625]', 'border', 'border-gold/30');
        btn.classList.remove('text-gray-400');
        loadUserOrders();
    } else {
        document.getElementById('tab-user-data').classList.remove('hidden');
        const btn = document.getElementById('btn-tab-data');
        btn.classList.add('text-gold', 'bg-[#111625]', 'border', 'border-gold/30');
        btn.classList.remove('text-gray-400');
        loadUserProfileData();
    }
}

// Carregar Dados do Perfil
function loadUserProfileData() {
    if (!currentUser) return;
    
    db.collection('users').doc(currentUser.uid).get().then(doc => {
        if (doc.exists) {
            const data = doc.data();
            document.getElementById('profile-name').value = data.name || '';
            document.getElementById('profile-email').value = data.email || currentUser.email;
            document.getElementById('profile-phone').value = data.phone || '';
            document.getElementById('profile-cpf').value = data.cpf || '';
            document.getElementById('profile-address').value = data.address || '';
        }
    });
}

// Salvar Dados do Perfil
function saveUserData(e) {
    e.preventDefault();
    const btn = e.target.querySelector('button');
    const originalText = btn.innerText;
    btn.innerText = "SALVANDO...";
    
    const updateData = {
        name: document.getElementById('profile-name').value,
        phone: document.getElementById('profile-phone').value,
        cpf: document.getElementById('profile-cpf').value,
        address: document.getElementById('profile-address').value
    };

    db.collection('users').doc(currentUser.uid).set(updateData, { merge: true })
        .then(() => {
            alert("Dados atualizados com sucesso!");
            document.getElementById('user-name-display').innerText = updateData.name;
            btn.innerText = originalText;
        })
        .catch(err => {
            alert("Erro: " + err.message);
            btn.innerText = originalText;
        });
}

// Carregar Pedidos do Usuário (Lista Simples)
function loadUserOrders() {
    const list = document.getElementById('account-orders-list');
    list.innerHTML = '<p class="text-gray-500 text-center py-4">Carregando pedidos...</p>';

    db.collection('checkout_attempts')
        .where('email', '==', currentUser.email)
        .orderBy('date', 'desc')
        .get()
        .then(snapshot => {
            if (snapshot.empty) {
                list.innerHTML = '<div class="text-center py-8"><p class="text-gray-400 mb-4">Você ainda não tem pedidos.</p><button onclick="closeModal(\'modal-account\'); checkLoginAndBuy(\'printed\')" class="btn-primary w-auto mx-auto px-6 py-2">FAZER MEU PRIMEIRO PEDIDO</button></div>';
                return;
            }

            let html = '';
            snapshot.forEach(doc => {
                const order = doc.data();
                const id = doc.id;
                const status = order.status || 'Aguardando Pagamento';
                const date = order.date ? new Date(order.date.seconds * 1000).toLocaleDateString() : '---';
                
                // Cor do Status na Lista
                let statusClass = 'text-yellow-500';
                if(status.includes('Aprovado') || status.includes('Entregue')) statusClass = 'text-green-500';
                if(status.includes('Cancelado') || status.includes('Recusado')) statusClass = 'text-red-500';
                if(status.includes('Coletado') || status.includes('Saiu')) statusClass = 'text-blue-400';

                html += `
                    <div onclick="showOrderDetails('${id}')" class="bg-[#111625] border border-gray-800 p-4 rounded cursor-pointer hover:border-gold/50 transition-all group">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-white font-bold text-sm">${order.product}</p>
                                <p class="text-xs text-gray-500">Pedido #${id.substr(0,8)}... • ${date}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs font-bold uppercase ${statusClass} mb-1">${status}</p>
                                <p class="text-xs text-gray-400">Ver Detalhes <i data-lucide="chevron-right" class="w-3 h-3 inline group-hover:translate-x-1 transition-transform"></i></p>
                            </div>
                        </div>
                    </div>
                `;
            });
            list.innerHTML = html;
            lucide.createIcons();
        });
}

// LÓGICA DA RÉGUA DE PROGRESSO (TIMELINE)
function showOrderDetails(orderId) {
    const view = document.getElementById('order-details-view');
    const content = document.getElementById('order-details-content');
    
    view.classList.remove('hidden');
    content.innerHTML = '<p class="text-center text-gold">Carregando detalhes...</p>';

    db.collection('checkout_attempts').doc(orderId).get().then(doc => {
        if(!doc.exists) return;
        const order = doc.data();
        const status = order.status || 'Pedido Realizado';
        
        // Mapeamento de Passos
        // 1: Realizado/Aguardando -> 2: Aprovado/Fabricação -> 3: Expedição -> 4: Transporte -> 5: Entregue
        // Status de Erro: Cancelado/Recusado
        
        let step = 1;
        let isError = false;

        if (['Pedido Realizado', 'Aguardando Pagamento'].includes(status)) step = 1;
        else if (['Pagamento Aprovado', 'Pedido em Fabricação', 'Fabricação Finalizada'].includes(status)) step = 2;
        else if (['Pedido na Expedição'].includes(status)) step = 3;
        else if (['Pedido Coletado', 'Pedido Saiu para Entrega'].includes(status)) step = 4;
        else if (['Pedido Entregue'].includes(status)) step = 5;
        else if (['Pagamento Recusado', 'Pedido Cancelado'].includes(status)) isError = true;

        // HTML da Timeline
        let timelineHTML = '';
        if(!isError) {
            const steps = [
                { l: 'Pedido', i: 'shopping-cart' },
                { l: 'Produção', i: 'hammer' },
                { l: 'Expedição', i: 'package' },
                { l: 'Transporte', i: 'truck' },
                { l: 'Entregue', i: 'check-circle' }
            ];

            timelineHTML = `<div class="flex justify-between items-center relative mb-8 px-2">
                <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-800 -z-0"></div>
                <div class="absolute top-1/2 left-0 h-1 bg-gradient-to-r from-gold to-yellow-600 -z-0 transition-all duration-1000" style="width: ${((step-1)/(steps.length-1))*100}%"></div>`;

            steps.forEach((s, index) => {
                const active = index + 1 <= step;
                const current = index + 1 === step;
                timelineHTML += `
                    <div class="flex flex-col items-center gap-2 z-10">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center border-2 transition-all ${active ? 'bg-gold border-gold text-black scale-110' : 'bg-[#0B0F19] border-gray-600 text-gray-600'}">
                            <i data-lucide="${s.i}" class="w-4 h-4"></i>
                        </div>
                        <span class="text-[9px] uppercase font-bold tracking-wider ${active ? 'text-gold' : 'text-gray-600'}">${s.l}</span>
                    </div>
                `;
            });
            timelineHTML += `</div>`;
        } else {
            timelineHTML = `
                <div class="bg-red-900/20 border border-red-500/50 p-4 rounded text-center mb-6">
                    <i data-lucide="x-circle" class="w-10 h-10 text-red-500 mx-auto mb-2"></i>
                    <p class="text-red-500 font-bold uppercase">Pedido Cancelado ou Recusado</p>
                    <p class="text-xs text-red-300">Entre em contato com o suporte se achar que houve um erro.</p>
                </div>
            `;
        }

        // Bloco de Rastreamento
        let trackingHTML = '';
        if (order.tracking_code) {
            trackingHTML = `
                <div class="bg-[#111625] border border-gold/30 p-4 rounded mb-6 text-center shadow-[0_0_15px_rgba(203,161,53,0.1)]">
                    <p class="text-xs text-gray-400 uppercase tracking-widest mb-1">Código de Rastreio</p>
                    <p class="text-xl text-white font-serif font-bold tracking-wider select-all">${order.tracking_code}</p>
                    <a href="https://www.melhorrastreio.com.br/rastreio/${order.tracking_code}" target="_blank" class="text-[10px] text-gold underline mt-2 block">CLIQUE PARA RASTREAR</a>
                </div>
            `;
        }

        content.innerHTML = `
            <div class="text-center mb-6">
                <p class="text-gray-400 text-xs uppercase tracking-widest">Status Atual</p>
                <h2 class="text-2xl text-gold font-serif font-bold mt-1">${status}</h2>
            </div>

            ${timelineHTML}
            ${trackingHTML}

            <div class="bg-[#111625] p-4 rounded border border-gray-800 space-y-3">
                <h3 class="text-white font-serif border-b border-gray-700 pb-2 mb-2">RESUMO</h3>
                <div class="flex justify-between text-sm"><span class="text-gray-400">Produto:</span> <span class="text-white">${order.product}</span></div>
                <div class="flex justify-between text-sm"><span class="text-gray-400">Valor:</span> <span class="text-gold font-bold">R$ ${order.price}</span></div>
                <div class="flex justify-between text-sm"><span class="text-gray-400">Data:</span> <span class="text-white">${new Date(order.date.seconds*1000).toLocaleDateString()}</span></div>
                <div class="flex justify-between text-sm"><span class="text-gray-400">Pagamento:</span> <span class="text-white">${order.paymentMethod || 'Sistema Online'}</span></div>
            </div>
        `;
        lucide.createIcons();
    });
}

function hideOrderDetails() {
    document.getElementById('order-details-view').classList.add('hidden');
}


// --- ADMINISTRAÇÃO ---

let adminCache = { orders: [], clients: [] };

function switchAdminTab(tab) {
    document.getElementById('admin-view-orders').classList.add('hidden');
    document.getElementById('admin-view-clients').classList.add('hidden');
    document.getElementById('adm-tab-orders').className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-transparent text-gray-500 hover:text-white';
    document.getElementById('adm-tab-clients').className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-transparent text-gray-500 hover:text-white';

    if(tab === 'orders') {
        document.getElementById('admin-view-orders').classList.remove('hidden');
        document.getElementById('adm-tab-orders').className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-red-500 text-white bg-red-900/10';
        loadAdminOrders();
    } else {
        document.getElementById('admin-view-clients').classList.remove('hidden');
        document.getElementById('adm-tab-clients').className = 'flex-1 py-4 text-sm font-bold text-center border-b-2 border-red-500 text-white bg-red-900/10';
        loadAdminClients();
    }
}

// Carregar Pedidos Admin
function loadAdminOrders() {
    const list = document.getElementById('admin-orders-list');
    list.innerHTML = '<p class="text-gray-400 text-center">Carregando...</p>';

    db.collection('checkout_attempts').orderBy('date', 'desc').get().then(snap => {
        adminCache.orders = [];
        snap.forEach(doc => adminCache.orders.push({id: doc.id, ...doc.data()}));
        renderAdminOrders(adminCache.orders);
    });
}

function renderAdminOrders(orders) {
    const list = document.getElementById('admin-orders-list');
    if(orders.length === 0) { list.innerHTML = '<p>Nada encontrado.</p>'; return; }
    
    let html = '';
    orders.forEach(o => {
        // Status Options Array
        const statuses = [
            'Pedido Realizado', 'Aguardando Pagamento', 'Pagamento Aprovado', 'Pagamento Recusado',
            'Pedido Cancelado', 'Pedido em Fabricação', 'Fabricação Finalizada',
            'Pedido na Expedição', 'Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue'
        ];
        
        // Verifica se precisa mostrar campo de rastreio
        const needsTracking = ['Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue'].includes(o.status);
        const trackingVal = o.tracking_code || '';

        let optionsHTML = statuses.map(s => `<option value="${s}" ${o.status === s ? 'selected' : ''}>${s}</option>`).join('');

        html += `
            <div class="bg-[#111625] border border-gray-800 p-4 rounded hover:border-red-500/30 transition-colors">
                <div class="flex flex-col md:flex-row justify-between gap-4">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="text-[10px] bg-gray-800 px-2 rounded text-gray-300 font-mono">${o.id}</span>
                            <span class="text-gold font-bold text-xs">${o.product}</span>
                        </div>
                        <p class="text-white font-bold">${o.name || 'Sem nome'}</p>
                        <p class="text-gray-400 text-xs">${o.email}</p>
                        <div class="mt-2 text-[10px] text-gray-500 grid grid-cols-2 gap-2">
                             <span>CPF: ${o.cpf || '-'}</span>
                             <span>Tel: ${o.phone || '-'}</span>
                        </div>
                    </div>
                    
                    <div class="flex flex-col gap-2 min-w-[200px]">
                        <label class="text-[9px] text-gray-500 uppercase font-bold">Status do Pedido</label>
                        <select onchange="updateAdminOrderStatus('${o.id}', this.value)" class="bg-black border border-gray-700 text-white text-xs p-2 rounded focus:border-red-500 outline-none">
                            ${optionsHTML}
                        </select>
                        
                        <div id="tracking-box-${o.id}" class="${needsTracking ? '' : 'hidden'}">
                             <input type="text" placeholder="Cód. Rastreio" value="${trackingVal}" 
                                onblur="saveTrackingCode('${o.id}', this.value)"
                                class="w-full bg-[#0B0F19] border border-gold/30 text-gold text-xs p-2 rounded placeholder-gray-600 focus:border-gold outline-none">
                        </div>

                        <div class="flex justify-end gap-2 mt-2">
                            <button onclick="editOrderData('${o.id}')" class="p-2 bg-blue-900/20 text-blue-400 rounded hover:bg-blue-900/40" title="Editar Dados"><i data-lucide="edit" class="w-4 h-4"></i></button>
                            <button onclick="deleteOrder('${o.id}')" class="p-2 bg-red-900/20 text-red-500 rounded hover:bg-red-900/40" title="Deletar"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        `;
    });
    list.innerHTML = html;
    lucide.createIcons();
}

function updateAdminOrderStatus(id, status) {
    const trackingBox = document.getElementById(`tracking-box-${id}`);
    
    // Mostra campo de rastreio se for status de envio
    if(['Pedido Coletado', 'Pedido Saiu para Entrega', 'Pedido Entregue'].includes(status)) {
        trackingBox.classList.remove('hidden');
    } else {
        trackingBox.classList.add('hidden');
    }

    db.collection('checkout_attempts').doc(id).update({ status: status })
        .then(() => alert(`Status atualizado para: ${status}`))
        .catch(err => alert("Erro: " + err));
}

function saveTrackingCode(id, code) {
    if(!code) return;
    db.collection('checkout_attempts').doc(id).update({ tracking_code: code })
        .then(() => console.log("Rastreio salvo"))
        .catch(err => alert("Erro ao salvar rastreio"));
}

function editOrderData(id) {
    const o = adminCache.orders.find(x => x.id === id);
    const newName = prompt("Nome:", o.name);
    const newEmail = prompt("Email:", o.email);
    const newProduct = prompt("Produto:", o.product);
    const newPrice = prompt("Preço:", o.price);
    
    if(newName && newEmail) {
        db.collection('checkout_attempts').doc(id).update({
            name: newName, email: newEmail, product: newProduct, price: newPrice
        }).then(() => {
            loadAdminOrders();
            alert("Pedido atualizado.");
        });
    }
}

// Carregar Clientes Admin
function loadAdminClients() {
    const list = document.getElementById('admin-clients-list');
    list.innerHTML = '<p class="text-center text-gray-500">Carregando clientes...</p>';
    
    db.collection('users').get().then(snap => {
        adminCache.clients = [];
        snap.forEach(doc => adminCache.clients.push({id: doc.id, ...doc.data()}));
        renderAdminClients(adminCache.clients);
    });
}

function renderAdminClients(clients) {
    const list = document.getElementById('admin-clients-list');
    if(clients.length === 0) { list.innerHTML = '<p>Nenhum cliente.</p>'; return; }

    let html = '';
    clients.forEach(c => {
        html += `
            <div class="bg-[#111625] p-4 rounded border border-gray-800 flex justify-between items-center">
                <div>
                    <p class="text-white font-bold text-sm uppercase">${c.name || 'Sem Nome'}</p>
                    <p class="text-gray-400 text-xs">${c.email}</p>
                    <p class="text-[10px] text-gray-600 mt-1">Role: ${c.role || 'user'} • Tel: ${c.phone || '-'}</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="deleteUserRecord('${c.id}')" class="text-red-500 hover:text-red-300"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                </div>
            </div>
        `;
    });
    list.innerHTML = html;
    lucide.createIcons();
}

function deleteUserRecord(id) {
    if(confirm("Isso deleta apenas os dados do banco, não a autenticação. Continuar?")) {
        db.collection('users').doc(id).delete().then(() => loadAdminClients());
    }
}

// Filtros
function filterAdminList(type) {
    const term = document.getElementById(type === 'order' ? 'admin-search-order' : 'admin-search-client').value.toLowerCase();
    
    if(type === 'order') {
        const filtered = adminCache.orders.filter(o => 
            (o.email && o.email.toLowerCase().includes(term)) || 
            (o.name && o.name.toLowerCase().includes(term)) || 
            (o.id.includes(term))
        );
        renderAdminOrders(filtered);
    } else {
        const filtered = adminCache.clients.filter(c => 
            (c.email && c.email.toLowerCase().includes(term)) || 
            (c.name && c.name.toLowerCase().includes(term))
        );
        renderAdminClients(filtered);
    }
}

// Atualizar chamada inicial
// Substitua a chamada antiga de openAccount() por esta, se quiser garantir atualização
window.openAccount = function() {
    if (!currentUser) return;
    openModal('modal-account');
    document.getElementById('user-name-display').innerText = currentUser.displayName || "CLIENTE";
    switchUserTab('orders'); // Padrão
}

window.openAdminPanel = function() {
    openModal('modal-admin');
    switchAdminTab('orders');
}
// Filtrar na tela (sem recarregar banco)
function filterOrders() {
    const term = document.getElementById('admin-search').value.toLowerCase();
    const content = document.getElementById('admin-content');
    
    const filtered = allOrdersCache.filter(order => 
        (order.email && order.email.toLowerCase().includes(term)) || 
        (order.name && order.name.toLowerCase().includes(term)) ||
        (order.id && order.id.includes(term))
    );

    if(filtered.length === 0) {
        content.innerHTML = '<p class="text-gray-500 text-center mt-4">Nada encontrado.</p>';
        return;
    }

    // Renderiza apenas os filtrados (Reutilizando lógica simples de HTML string)
    // Nota: Para manter o código curto, vou chamar loadAllOrders se o campo estiver vazio
    // Se estiver preenchido, o ideal seria ter a função de renderização separada, 
    // mas aqui vou apenas esconder os elementos que não batem para simplificar.
    
    allOrdersCache.forEach(order => {
        const el = document.getElementById(`card-${order.id}`);
        if(el) {
            if((order.email && order.email.toLowerCase().includes(term)) || 
               (order.name && order.name.toLowerCase().includes(term))) {
                el.style.display = 'block';
            } else {
                el.style.display = 'none';
            }
        }
    });
}

   
    </script>
</body>
</html>
